BEGIN
DECLARE _ERROR_CODE INT64;
DECLARE _ERROR_MESSAGE STRING;
/*SET QUERY_BAND = '
App_ID=APP04070;
DAG_ID=merch_transaction_dept_channel_week_agg_fact_load;
---Task_Name=agg_fact_load_1_209;'*/
---FOR SESSION VOLATILE;

BEGIN
SET _ERROR_CODE  =  0;

INSERT INTO `{{params.gcp_project_id}}`.{{params.dbenv}}_nap_fct.merch_transaction_dept_channel_week_agg_fact 

(channel_num, banner_num, channel_country,
 department_num, department_desc, subdivision_num, subdivision_desc, division_num, division_desc, week_num, month_num,
 month_label, quarter_num, halfyear_num, year_num, jwn_demand_total_units_ty, jwn_demand_total_retail_amt_ty,
 jwn_demand_regular_units_ty, jwn_demand_regular_retail_amt_ty, jwn_demand_promo_units_ty,
 jwn_demand_promo_retail_amt_ty, jwn_demand_clearance_units_ty, jwn_demand_clearance_retail_amt_ty,
 jwn_demand_store_fulfilled_units_ty, jwn_demand_store_fulfilled_retail_amt_ty,
 jwn_demand_store_fulfilled_regular_units_ty, jwn_demand_store_fulfilled_regular_retail_amt_ty,
 jwn_demand_store_fulfilled_promo_units_ty, jwn_demand_store_fulfilled_promo_retail_amt_ty,
 jwn_demand_store_fulfilled_clearance_units_ty, jwn_demand_store_fulfilled_clearance_retail_amt_ty,
 jwn_demand_persistent_units_ty, jwn_demand_persistent_retail_amt_ty, jwn_demand_persistent_regular_units_ty,
 jwn_demand_persistent_regular_retail_amt_ty, jwn_demand_persistent_promo_units_ty,
 jwn_demand_persistent_promo_retail_amt_ty, jwn_demand_persistent_clearance_units_ty,
 jwn_demand_persistent_clearance_retail_amt_ty, jwn_demand_other_fulfilled_units_ty,
 jwn_demand_other_fulfilled_retail_amt_ty, jwn_demand_other_fulfilled_regular_units_ty,
 jwn_demand_other_fulfilled_regular_retail_amt_ty, jwn_demand_other_fulfilled_promo_units_ty,
 jwn_demand_other_fulfilled_promo_retail_amt_ty, jwn_demand_other_fulfilled_clearance_units_ty,
 jwn_demand_other_fulfilled_clearance_retail_amt_ty, jwn_demand_fulfillment_center_fulfilled_units_ty,
 jwn_demand_fulfillment_center_fulfilled_retail_amt_ty, jwn_demand_fulfillment_center_fulfilled_regular_units_ty,
 jwn_demand_fulfillment_center_fulfilled_regular_retail_amt_ty, jwn_demand_fulfillment_center_fulfilled_promo_units_ty,
 jwn_demand_fulfillment_center_fulfilled_promo_retail_amt_ty, jwn_demand_fulfillment_center_fulfilled_clearance_units_ty
 , jwn_demand_fulfillment_center_fulfilled_clearance_retail_amt_ty, jwn_demand_flash_units_ty,
 jwn_demand_flash_retail_amt_ty, jwn_demand_flash_regular_units_ty, jwn_demand_flash_regular_retail_amt_ty,
 jwn_demand_flash_promo_units_ty, jwn_demand_flash_promo_retail_amt_ty, jwn_demand_flash_clearance_units_ty,
 jwn_demand_flash_clearance_retail_amt_ty, jwn_demand_dropship_fulfilled_units_ty,
 jwn_demand_dropship_fulfilled_retail_amt_ty, jwn_demand_dropship_fulfilled_regular_units_ty,
 jwn_demand_dropship_fulfilled_regular_retail_amt_ty, jwn_demand_dropship_fulfilled_promo_units_ty,
 jwn_demand_dropship_fulfilled_promo_retail_amt_ty, jwn_demand_dropship_fulfilled_clearance_units_ty,
 jwn_demand_dropship_fulfilled_clearance_retail_amt_ty, jwn_operational_gmv_total_units_ty,
 jwn_operational_gmv_total_retail_amt_ty, jwn_operational_gmv_total_cost_amt_ty, jwn_operational_gmv_regular_units_ty,
 jwn_operational_gmv_regular_retail_amt_ty, jwn_operational_gmv_regular_cost_amt_ty, jwn_operational_gmv_promo_units_ty
 , jwn_operational_gmv_promo_retail_amt_ty, jwn_operational_gmv_promo_cost_amt_ty,
 jwn_operational_gmv_clearance_units_ty, jwn_operational_gmv_clearance_retail_amt_ty,
 jwn_operational_gmv_clearance_cost_amt_ty, jwn_operational_gmv_persistent_units_ty,
 jwn_operational_gmv_persistent_retail_amt_ty, jwn_operational_gmv_persistent_cost_amt_ty,
 jwn_operational_gmv_persistent_regular_units_ty, jwn_operational_gmv_persistent_regular_retail_amt_ty,
 jwn_operational_gmv_persistent_regular_cost_amt_ty, jwn_operational_gmv_persistent_promo_units_ty,
 jwn_operational_gmv_persistent_promo_retail_amt_ty, jwn_operational_gmv_persistent_promo_cost_amt_ty,
 jwn_operational_gmv_persistent_clearance_units_ty, jwn_operational_gmv_persistent_clearance_retail_amt_ty,
 jwn_operational_gmv_persistent_clearance_cost_amt_ty, jwn_operational_gmv_flash_units_ty,
 jwn_operational_gmv_flash_retail_amt_ty, jwn_operational_gmv_flash_cost_amt_ty,
 jwn_operational_gmv_flash_regular_units_ty, jwn_operational_gmv_flash_regular_retail_amt_ty,
 jwn_operational_gmv_flash_regular_cost_amt_ty, jwn_operational_gmv_flash_promo_units_ty,
 jwn_operational_gmv_flash_promo_retail_amt_ty, jwn_operational_gmv_flash_promo_cost_amt_ty,
 jwn_operational_gmv_flash_clearance_units_ty, jwn_operational_gmv_flash_clearance_retail_amt_ty,
 jwn_operational_gmv_flash_clearance_cost_amt_ty, jwn_gross_sales_total_units_ty, jwn_gross_sales_total_retail_amt_ty,
 jwn_gross_sales_total_cost_amt_ty, jwn_gross_sales_regular_units_ty, jwn_gross_sales_regular_retail_amt_ty,
 jwn_gross_sales_regular_cost_amt_ty, jwn_gross_sales_promo_units_ty, jwn_gross_sales_promo_retail_amt_ty,
 jwn_gross_sales_promo_cost_amt_ty, jwn_gross_sales_clearance_units_ty, jwn_gross_sales_clearance_retail_amt_ty,
 jwn_gross_sales_clearance_cost_amt_ty, jwn_returns_total_units_ty, jwn_returns_total_retail_amt_ty,
 jwn_returns_total_cost_amt_ty, jwn_returns_regular_units_ty, jwn_returns_regular_retail_amt_ty,
 jwn_returns_regular_cost_amt_ty, jwn_returns_promo_units_ty, jwn_returns_promo_retail_amt_ty,
 jwn_returns_promo_cost_amt_ty, jwn_returns_clearance_units_ty, jwn_returns_clearance_retail_amt_ty,
 jwn_returns_clearance_cost_amt_ty, receipts_total_units_ty, receipts_total_retail_amt_ty, receipts_total_cost_amt_ty,
 receipts_po_units_ty, receipts_po_retail_amt_ty, receipts_po_cost_amt_ty, receipts_dropship_units_ty,
 receipts_dropship_retail_amt_ty, receipts_dropship_cost_amt_ty, transfer_in_pack_and_hold_units_ty,
 transfer_in_pack_and_hold_retail_amt_ty, transfer_in_pack_and_hold_cost_amt_ty, transfer_in_reserve_stock_units_ty,
 transfer_in_reserve_stock_retail_amt_ty, transfer_in_reserve_stock_cost_amt_ty, transfer_in_racking_units_ty,
 transfer_in_racking_retail_amt_ty, transfer_in_racking_cost_amt_ty, transfer_out_racking_units_ty,
 transfer_out_racking_retail_amt_ty, transfer_out_racking_cost_amt_ty, transfer_in_return_to_rack_units_ty,
 transfer_in_return_to_rack_retail_amt_ty, transfer_in_return_to_rack_cost_amt_ty, inventory_boh_total_units_ty,
 inventory_boh_total_retail_amt_ty, inventory_boh_total_cost_amt_ty, inventory_boh_regular_units_ty,
 inventory_boh_regular_retail_amt_ty, inventory_boh_regular_cost_amt_ty, inventory_boh_clearance_units_ty,
 inventory_boh_clearance_retail_amt_ty, inventory_boh_clearance_cost_amt_ty, inventory_eoh_total_units_ty,
 inventory_eoh_total_retail_amt_ty, inventory_eoh_total_cost_amt_ty, inventory_eoh_regular_units_ty,
 inventory_eoh_regular_retail_amt_ty, inventory_eoh_regular_cost_amt_ty, inventory_eoh_clearance_units_ty,
 inventory_eoh_clearance_retail_amt_ty, inventory_eoh_clearance_cost_amt_ty, rtv_total_units_ty, rtv_total_retail_amt_ty
 , rtv_total_cost_amt_ty, jwn_demand_total_units_ly, jwn_demand_total_retail_amt_ly, jwn_demand_regular_units_ly,
 jwn_demand_regular_retail_amt_ly, jwn_demand_promo_units_ly, jwn_demand_promo_retail_amt_ly,
 jwn_demand_clearance_units_ly, jwn_demand_clearance_retail_amt_ly, jwn_demand_store_fulfilled_units_ly,
 jwn_demand_store_fulfilled_retail_amt_ly, jwn_demand_store_fulfilled_regular_units_ly,
 jwn_demand_store_fulfilled_regular_retail_amt_ly, jwn_demand_store_fulfilled_promo_units_ly,
 jwn_demand_store_fulfilled_promo_retail_amt_ly, jwn_demand_store_fulfilled_clearance_units_ly,
 jwn_demand_store_fulfilled_clearance_retail_amt_ly, jwn_demand_persistent_units_ly, jwn_demand_persistent_retail_amt_ly
 , jwn_demand_persistent_regular_units_ly, jwn_demand_persistent_regular_retail_amt_ly,
 jwn_demand_persistent_promo_units_ly, jwn_demand_persistent_promo_retail_amt_ly,
 jwn_demand_persistent_clearance_units_ly, jwn_demand_persistent_clearance_retail_amt_ly,
 jwn_demand_other_fulfilled_units_ly, jwn_demand_other_fulfilled_retail_amt_ly,
 jwn_demand_other_fulfilled_regular_units_ly, jwn_demand_other_fulfilled_regular_retail_amt_ly,
 jwn_demand_other_fulfilled_promo_units_ly, jwn_demand_other_fulfilled_promo_retail_amt_ly,
 jwn_demand_other_fulfilled_clearance_units_ly, jwn_demand_other_fulfilled_clearance_retail_amt_ly,
 jwn_demand_fulfillment_center_fulfilled_units_ly, jwn_demand_fulfillment_center_fulfilled_retail_amt_ly,
 jwn_demand_fulfillment_center_fulfilled_regular_units_ly, jwn_demand_fulfillment_center_fulfilled_regular_retail_amt_ly
 , jwn_demand_fulfillment_center_fulfilled_promo_units_ly, jwn_demand_fulfillment_center_fulfilled_promo_retail_amt_ly,
 jwn_demand_fulfillment_center_fulfilled_clearance_units_ly,
 jwn_demand_fulfillment_center_fulfilled_clearance_retail_amt_ly, jwn_demand_flash_units_ly,
 jwn_demand_flash_retail_amt_ly, jwn_demand_flash_regular_units_ly, jwn_demand_flash_regular_retail_amt_ly,
 jwn_demand_flash_promo_units_ly, jwn_demand_flash_promo_retail_amt_ly, jwn_demand_flash_clearance_units_ly,
 jwn_demand_flash_clearance_retail_amt_ly, jwn_demand_dropship_fulfilled_units_ly,
 jwn_demand_dropship_fulfilled_retail_amt_ly, jwn_demand_dropship_fulfilled_regular_units_ly,
 jwn_demand_dropship_fulfilled_regular_retail_amt_ly, jwn_demand_dropship_fulfilled_promo_units_ly,
 jwn_demand_dropship_fulfilled_promo_retail_amt_ly, jwn_demand_dropship_fulfilled_clearance_units_ly,
 jwn_demand_dropship_fulfilled_clearance_retail_amt_ly, jwn_operational_gmv_total_units_ly,
 jwn_operational_gmv_total_retail_amt_ly, jwn_operational_gmv_total_cost_amt_ly, jwn_operational_gmv_regular_units_ly,
 jwn_operational_gmv_regular_retail_amt_ly, jwn_operational_gmv_regular_cost_amt_ly, jwn_operational_gmv_promo_units_ly
 , jwn_operational_gmv_promo_retail_amt_ly, jwn_operational_gmv_promo_cost_amt_ly,
 jwn_operational_gmv_clearance_units_ly, jwn_operational_gmv_clearance_retail_amt_ly,
 jwn_operational_gmv_clearance_cost_amt_ly, jwn_operational_gmv_persistent_units_ly,
 jwn_operational_gmv_persistent_retail_amt_ly, jwn_operational_gmv_persistent_cost_amt_ly,
 jwn_operational_gmv_persistent_regular_units_ly, jwn_operational_gmv_persistent_regular_retail_amt_ly,
 jwn_operational_gmv_persistent_regular_cost_amt_ly, jwn_operational_gmv_persistent_promo_units_ly,
 jwn_operational_gmv_persistent_promo_retail_amt_ly, jwn_operational_gmv_persistent_promo_cost_amt_ly,
 jwn_operational_gmv_persistent_clearance_units_ly, jwn_operational_gmv_persistent_clearance_retail_amt_ly,
 jwn_operational_gmv_persistent_clearance_cost_amt_ly, jwn_operational_gmv_flash_units_ly,
 jwn_operational_gmv_flash_retail_amt_ly, jwn_operational_gmv_flash_cost_amt_ly,
 jwn_operational_gmv_flash_regular_units_ly, jwn_operational_gmv_flash_regular_retail_amt_ly,
 jwn_operational_gmv_flash_regular_cost_amt_ly, jwn_operational_gmv_flash_promo_units_ly,
 jwn_operational_gmv_flash_promo_retail_amt_ly, jwn_operational_gmv_flash_promo_cost_amt_ly,
 jwn_operational_gmv_flash_clearance_units_ly, jwn_operational_gmv_flash_clearance_retail_amt_ly,
 jwn_operational_gmv_flash_clearance_cost_amt_ly, jwn_gross_sales_total_units_ly, jwn_gross_sales_total_retail_amt_ly,
 jwn_gross_sales_total_cost_amt_ly, jwn_gross_sales_regular_units_ly, jwn_gross_sales_regular_retail_amt_ly,
 jwn_gross_sales_regular_cost_amt_ly, jwn_gross_sales_promo_units_ly, jwn_gross_sales_promo_retail_amt_ly,
 jwn_gross_sales_promo_cost_amt_ly, jwn_gross_sales_clearance_units_ly, jwn_gross_sales_clearance_retail_amt_ly,
 jwn_gross_sales_clearance_cost_amt_ly, jwn_returns_total_units_ly, jwn_returns_total_retail_amt_ly,
 jwn_returns_total_cost_amt_ly, jwn_returns_regular_units_ly, jwn_returns_regular_retail_amt_ly,
 jwn_returns_regular_cost_amt_ly, jwn_returns_promo_units_ly, jwn_returns_promo_retail_amt_ly,
 jwn_returns_promo_cost_amt_ly, jwn_returns_clearance_units_ly, jwn_returns_clearance_retail_amt_ly,
 jwn_returns_clearance_cost_amt_ly, receipts_total_units_ly, receipts_total_retail_amt_ly, receipts_total_cost_amt_ly,
 receipts_po_units_ly, receipts_po_retail_amt_ly, receipts_po_cost_amt_ly, receipts_dropship_units_ly,
 receipts_dropship_retail_amt_ly, receipts_dropship_cost_amt_ly, transfer_in_pack_and_hold_units_ly,
 transfer_in_pack_and_hold_retail_amt_ly, transfer_in_pack_and_hold_cost_amt_ly, transfer_in_reserve_stock_units_ly,
 transfer_in_reserve_stock_retail_amt_ly, transfer_in_reserve_stock_cost_amt_ly, transfer_in_racking_units_ly,
 transfer_in_racking_retail_amt_ly, transfer_in_racking_cost_amt_ly, transfer_out_racking_units_ly,
 transfer_out_racking_retail_amt_ly, transfer_out_racking_cost_amt_ly, transfer_in_return_to_rack_units_ly,
 transfer_in_return_to_rack_retail_amt_ly, transfer_in_return_to_rack_cost_amt_ly, inventory_boh_total_units_ly,
 inventory_boh_total_retail_amt_ly, inventory_boh_total_cost_amt_ly, inventory_boh_regular_units_ly,
 inventory_boh_regular_retail_amt_ly, inventory_boh_regular_cost_amt_ly, inventory_boh_clearance_units_ly,
 inventory_boh_clearance_retail_amt_ly, inventory_boh_clearance_cost_amt_ly, inventory_eoh_total_units_ly,
 inventory_eoh_total_retail_amt_ly, inventory_eoh_total_cost_amt_ly, inventory_eoh_regular_units_ly,
 inventory_eoh_regular_retail_amt_ly, inventory_eoh_regular_cost_amt_ly, inventory_eoh_clearance_units_ly,
 inventory_eoh_clearance_retail_amt_ly, inventory_eoh_clearance_cost_amt_ly, rtv_total_units_ly, rtv_total_retail_amt_ly
 , rtv_total_cost_amt_ly, mos_total_cost_amt_ty, mos_regular_cost_amt_ty, mos_clearance_cost_amt_ty, mos_total_units_ty
 , mos_regular_units_ty, mos_clearance_units_ty, mos_total_retail_amt_ty, mos_regular_retail_amt_ty,
 mos_clearance_retail_amt_ty, mos_total_cost_amt_ly, mos_regular_cost_amt_ly, mos_clearance_cost_amt_ly,
 mos_total_units_ly, mos_regular_units_ly, mos_clearance_units_ly, mos_total_retail_amt_ly, mos_regular_retail_amt_ly,
 mos_clearance_retail_amt_ly, receipts_regular_retail_amt_ty, receipts_regular_units_ty, receipts_regular_cost_amt_ty,
 receipts_clearance_retail_amt_ty, receipts_clearance_units_ty, receipts_clearance_cost_amt_ty,
 receipts_crossdock_regular_retail_amt_ty, receipts_crossdock_regular_units_ty, receipts_crossdock_regular_cost_amt_ty,
 receipts_crossdock_clearance_retail_amt_ty, receipts_crossdock_clearance_units_ty,
 receipts_crossdock_clearance_cost_amt_ty, receipts_regular_retail_amt_ly, receipts_regular_units_ly,
 receipts_regular_cost_amt_ly, receipts_clearance_retail_amt_ly, receipts_clearance_units_ly,
 receipts_clearance_cost_amt_ly, receipts_crossdock_regular_retail_amt_ly, receipts_crossdock_regular_units_ly,
 receipts_crossdock_regular_cost_amt_ly, receipts_crossdock_clearance_retail_amt_ly,
 receipts_crossdock_clearance_units_ly, receipts_crossdock_clearance_cost_amt_ly,
 transfer_in_racking_regular_cost_amt_ty, transfer_in_racking_clearance_cost_amt_ty,
 transfer_in_racking_regular_units_ty, transfer_in_racking_clearance_units_ty, transfer_out_racking_regular_cost_amt_ty
 , transfer_out_racking_clearance_cost_amt_ty, transfer_out_racking_regular_units_ty,
 transfer_out_racking_clearance_units_ty, transfer_in_pack_and_hold_regular_cost_amt_ty,
 transfer_in_pack_and_hold_clearance_cost_amt_ty, transfer_in_pack_and_hold_regular_units_ty,
 transfer_in_pack_and_hold_clearance_units_ty, transfer_out_pack_and_hold_cost_amt_ty,
 transfer_out_pack_and_hold_regular_cost_amt_ty, transfer_out_pack_and_hold_clearance_cost_amt_ty,
 transfer_out_pack_and_hold_units_ty, transfer_out_pack_and_hold_regular_units_ty,
 transfer_out_pack_and_hold_clearance_units_ty, transfer_in_reserve_stock_regular_cost_amt_ty,
 transfer_in_reserve_stock_clearance_cost_amt_ty, transfer_in_reserve_stock_regular_units_ty,
 transfer_in_reserve_stock_clearance_units_ty, transfer_out_reserve_stock_cost_amt_ty,
 transfer_out_reserve_stock_regular_cost_amt_ty, transfer_out_reserve_stock_clearance_cost_amt_ty,
 transfer_out_reserve_stock_units_ty, transfer_out_reserve_stock_regular_units_ty,
 transfer_out_reserve_stock_clearance_units_ty, transfer_in_racking_regular_cost_amt_ly,
 transfer_in_racking_clearance_cost_amt_ly, transfer_in_racking_regular_units_ly, transfer_in_racking_clearance_units_ly
 , transfer_out_racking_regular_cost_amt_ly, transfer_out_racking_clearance_cost_amt_ly,
 transfer_out_racking_regular_units_ly, transfer_out_racking_clearance_units_ly,
 transfer_in_pack_and_hold_regular_cost_amt_ly, transfer_in_pack_and_hold_clearance_cost_amt_ly,
 transfer_in_pack_and_hold_regular_units_ly, transfer_in_pack_and_hold_clearance_units_ly,
 transfer_out_pack_and_hold_cost_amt_ly, transfer_out_pack_and_hold_regular_cost_amt_ly,
 transfer_out_pack_and_hold_clearance_cost_amt_ly, transfer_out_pack_and_hold_units_ly,
 transfer_out_pack_and_hold_regular_units_ly, transfer_out_pack_and_hold_clearance_units_ly,
 transfer_in_reserve_stock_regular_cost_amt_ly, transfer_in_reserve_stock_clearance_cost_amt_ly,
 transfer_in_reserve_stock_regular_units_ly, transfer_in_reserve_stock_clearance_units_ly,
 transfer_out_reserve_stock_cost_amt_ly, transfer_out_reserve_stock_regular_cost_amt_ly,
 transfer_out_reserve_stock_clearance_cost_amt_ly, transfer_out_reserve_stock_units_ly,
 transfer_out_reserve_stock_regular_units_ly, transfer_out_reserve_stock_clearance_units_ly,
 inventory_eoh_in_transit_regular_units_ty, inventory_eoh_in_transit_regular_cost_amt_ty,
 inventory_eoh_in_transit_regular_retail_amt_ty, inventory_eoh_in_transit_clearance_units_ty,
 inventory_eoh_in_transit_clearance_cost_amt_ty, inventory_eoh_in_transit_clearance_retail_amt_ty,
 inventory_eoh_in_transit_total_units_ty, inventory_eoh_in_transit_total_cost_amt_ty,
 inventory_eoh_in_transit_total_retail_amt_ty, inventory_boh_in_transit_regular_units_ty,
 inventory_boh_in_transit_regular_cost_amt_ty, inventory_boh_in_transit_regular_retail_amt_ty,
 inventory_boh_in_transit_clearance_units_ty, inventory_boh_in_transit_clearance_cost_amt_ty,
 inventory_boh_in_transit_clearance_retail_amt_ty, inventory_boh_in_transit_total_units_ty,
 inventory_boh_in_transit_total_cost_amt_ty, inventory_boh_in_transit_total_retail_amt_ty,
 inventory_eoh_in_transit_regular_units_ly, inventory_eoh_in_transit_regular_cost_amt_ly,
 inventory_eoh_in_transit_regular_retail_amt_ly, inventory_eoh_in_transit_clearance_units_ly,
 inventory_eoh_in_transit_clearance_cost_amt_ly, inventory_eoh_in_transit_clearance_retail_amt_ly,
 inventory_eoh_in_transit_total_units_ly, inventory_eoh_in_transit_total_cost_amt_ly,
 inventory_eoh_in_transit_total_retail_amt_ly, inventory_boh_in_transit_regular_units_ly,
 inventory_boh_in_transit_regular_cost_amt_ly, inventory_boh_in_transit_regular_retail_amt_ly,
 inventory_boh_in_transit_clearance_units_ly, inventory_boh_in_transit_clearance_cost_amt_ly,
 inventory_boh_in_transit_clearance_retail_amt_ly, inventory_boh_in_transit_total_units_ly,
 inventory_boh_in_transit_total_cost_amt_ly, inventory_boh_in_transit_total_retail_amt_ly, dw_sys_load_tmstp,
 dw_batch_date)
(SELECT mtsswaf.channel_num,
  mtsswaf.banner_country_num AS banner_num,
  COALESCE(occbd.channel_country, 'UNKNOWN') AS channel_country,
  COALESCE(dept.dept_num, - 1) AS department_num,
  COALESCE(dept.dept_name, 'UNKNOWN') AS department_desc,
  COALESCE(dept.subdivision_num, - 1) AS subdivision_num,
  COALESCE(dept.subdivision_name, 'UNKNOWN') AS subdivision_desc,
  COALESCE(dept.division_num, - 1) AS division_num,
  COALESCE(dept.division_name, 'UNKNOWN') AS division_desc,
  cal.week_idnt AS week_num,
  cal.month_idnt AS month_num,
  cal.month_label,
  cal.fiscal_quarter_num AS quarter_num,
  cal.fiscal_halfyear_num AS halfyear_num,
  cal.fiscal_year_num AS year_num,
  SUM(mtsswaf.jwn_demand_total_units_ty) AS jwn_demand_total_units_ty,
  SUM(mtsswaf.jwn_demand_total_retail_amt_ty) AS jwn_demand_total_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_regular_units_ty) AS jwn_demand_regular_units_ty,
  SUM(mtsswaf.jwn_demand_regular_retail_amt_ty) AS jwn_demand_regular_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_promo_units_ty) AS jwn_demand_promo_units_ty,
  SUM(mtsswaf.jwn_demand_promo_retail_amt_ty) AS jwn_demand_promo_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_clearance_units_ty) AS jwn_demand_clearance_units_ty,
  SUM(mtsswaf.jwn_demand_clearance_retail_amt_ty) AS jwn_demand_clearance_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_store_fulfilled_units_ty) AS jwn_demand_store_fulfilled_units_ty,
  SUM(mtsswaf.jwn_demand_store_fulfilled_retail_amt_ty) AS jwn_demand_store_fulfilled_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_store_fulfilled_regular_units_ty) AS jwn_demand_store_fulfilled_regular_units_ty,
  SUM(mtsswaf.jwn_demand_store_fulfilled_regular_retail_amt_ty) AS jwn_demand_store_fulfilled_regular_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_store_fulfilled_promo_units_ty) AS jwn_demand_store_fulfilled_promo_units_ty,
  SUM(mtsswaf.jwn_demand_store_fulfilled_promo_retail_amt_ty) AS jwn_demand_store_fulfilled_promo_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_store_fulfilled_clearance_units_ty) AS jwn_demand_store_fulfilled_clearance_units_ty,
  SUM(mtsswaf.jwn_demand_store_fulfilled_clearance_retail_amt_ty) AS jwn_demand_store_fulfilled_clearance_retail_amt_ty
  ,
  SUM(mtsswaf.jwn_demand_persistent_units_ty) AS jwn_demand_persistent_units_ty,
  SUM(mtsswaf.jwn_demand_persistent_retail_amt_ty) AS jwn_demand_persistent_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_persistent_regular_units_ty) AS jwn_demand_persistent_regular_units_ty,
  SUM(mtsswaf.jwn_demand_persistent_regular_retail_amt_ty) AS jwn_demand_persistent_regular_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_persistent_promo_units_ty) AS jwn_demand_persistent_promo_units_ty,
  SUM(mtsswaf.jwn_demand_persistent_promo_retail_amt_ty) AS jwn_demand_persistent_promo_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_persistent_clearance_units_ty) AS jwn_demand_persistent_clearance_units_ty,
  SUM(mtsswaf.jwn_demand_persistent_clearance_retail_amt_ty) AS jwn_demand_persistent_clearance_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_other_fulfilled_units_ty) AS jwn_demand_other_fulfilled_units_ty,
  SUM(mtsswaf.jwn_demand_other_fulfilled_retail_amt_ty) AS jwn_demand_other_fulfilled_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_other_fulfilled_regular_units_ty) AS jwn_demand_other_fulfilled_regular_units_ty,
  SUM(mtsswaf.jwn_demand_other_fulfilled_regular_retail_amt_ty) AS jwn_demand_other_fulfilled_regular_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_other_fulfilled_promo_units_ty) AS jwn_demand_other_fulfilled_promo_units_ty,
  SUM(mtsswaf.jwn_demand_other_fulfilled_promo_retail_amt_ty) AS jwn_demand_other_fulfilled_promo_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_other_fulfilled_clearance_units_ty) AS jwn_demand_other_fulfilled_clearance_units_ty,
  SUM(mtsswaf.jwn_demand_other_fulfilled_clearance_retail_amt_ty) AS jwn_demand_other_fulfilled_clearance_retail_amt_ty
  ,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_units_ty) AS jwn_demand_fulfillment_center_fulfilled_units_ty,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_retail_amt_ty) AS
  jwn_demand_fulfillment_center_fulfilled_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_regular_units_ty) AS
  jwn_demand_fulfillment_center_fulfilled_regular_units_ty,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_regular_retail_amt_ty) AS
  jwn_demand_fulfillment_center_fulfilled_regular_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_promo_units_ty) AS
  jwn_demand_fulfillment_center_fulfilled_promo_units_ty,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_promo_retail_amt_ty) AS
  jwn_demand_fulfillment_center_fulfilled_promo_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_clearance_units_ty) AS
  jwn_demand_fulfillment_center_fulfilled_clearance_units_ty,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_clearance_retail_amt_ty) AS
  jwn_demand_fulfillment_center_fulfilled_clearance_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_flash_units_ty) AS jwn_demand_flash_units_ty,
  SUM(mtsswaf.jwn_demand_flash_retail_amt_ty) AS jwn_demand_flash_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_flash_regular_units_ty) AS jwn_demand_flash_regular_units_ty,
  SUM(mtsswaf.jwn_demand_flash_regular_retail_amt_ty) AS jwn_demand_flash_regular_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_flash_promo_units_ty) AS jwn_demand_flash_promo_units_ty,
  SUM(mtsswaf.jwn_demand_flash_promo_retail_amt_ty) AS jwn_demand_flash_promo_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_flash_clearance_units_ty) AS jwn_demand_flash_clearance_units_ty,
  SUM(mtsswaf.jwn_demand_flash_clearance_retail_amt_ty) AS jwn_demand_flash_clearance_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_units_ty) AS jwn_demand_dropship_fulfilled_units_ty,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_retail_amt_ty) AS jwn_demand_dropship_fulfilled_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_regular_units_ty) AS jwn_demand_dropship_fulfilled_regular_units_ty,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_regular_retail_amt_ty) AS
  jwn_demand_dropship_fulfilled_regular_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_promo_units_ty) AS jwn_demand_dropship_fulfilled_promo_units_ty,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_promo_retail_amt_ty) AS jwn_demand_dropship_fulfilled_promo_retail_amt_ty,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_clearance_units_ty) AS jwn_demand_dropship_fulfilled_clearance_units_ty,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_clearance_retail_amt_ty) AS
  jwn_demand_dropship_fulfilled_clearance_retail_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_total_units_ty) AS jwn_operational_gmv_total_units_ty,
  SUM(mtsswaf.jwn_operational_gmv_total_retail_amt_ty) AS jwn_operational_gmv_total_retail_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_total_cost_amt_ty) AS jwn_operational_gmv_total_cost_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_regular_units_ty) AS jwn_operational_gmv_regular_units_ty,
  SUM(mtsswaf.jwn_operational_gmv_regular_retail_amt_ty) AS jwn_operational_gmv_regular_retail_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_regular_cost_amt_ty) AS jwn_operational_gmv_regular_cost_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_promo_units_ty) AS jwn_operational_gmv_promo_units_ty,
  SUM(mtsswaf.jwn_operational_gmv_promo_retail_amt_ty) AS jwn_operational_gmv_promo_retail_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_promo_cost_amt_ty) AS jwn_operational_gmv_promo_cost_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_clearance_units_ty) AS jwn_operational_gmv_clearance_units_ty,
  SUM(mtsswaf.jwn_operational_gmv_clearance_retail_amt_ty) AS jwn_operational_gmv_clearance_retail_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_clearance_cost_amt_ty) AS jwn_operational_gmv_clearance_cost_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_persistent_units_ty) AS jwn_operational_gmv_persistent_units_ty,
  SUM(mtsswaf.jwn_operational_gmv_persistent_retail_amt_ty) AS jwn_operational_gmv_persistent_retail_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_persistent_cost_amt_ty) AS jwn_operational_gmv_persistent_cost_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_persistent_regular_units_ty) AS jwn_operational_gmv_persistent_regular_units_ty,
  SUM(mtsswaf.jwn_operational_gmv_persistent_regular_retail_amt_ty) AS
  jwn_operational_gmv_persistent_regular_retail_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_persistent_regular_cost_amt_ty) AS jwn_operational_gmv_persistent_regular_cost_amt_ty
  ,
  SUM(mtsswaf.jwn_operational_gmv_persistent_promo_units_ty) AS jwn_operational_gmv_persistent_promo_units_ty,
  SUM(mtsswaf.jwn_operational_gmv_persistent_promo_retail_amt_ty) AS jwn_operational_gmv_persistent_promo_retail_amt_ty
  ,
  SUM(mtsswaf.jwn_operational_gmv_persistent_promo_cost_amt_ty) AS jwn_operational_gmv_persistent_promo_cost_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_persistent_clearance_units_ty) AS jwn_operational_gmv_persistent_clearance_units_ty,
  SUM(mtsswaf.jwn_operational_gmv_persistent_clearance_retail_amt_ty) AS
  jwn_operational_gmv_persistent_clearance_retail_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_persistent_clearance_cost_amt_ty) AS
  jwn_operational_gmv_persistent_clearance_cost_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_flash_units_ty) AS jwn_operational_gmv_flash_units_ty,
  SUM(mtsswaf.jwn_operational_gmv_flash_retail_amt_ty) AS jwn_operational_gmv_flash_retail_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_flash_cost_amt_ty) AS jwn_operational_gmv_flash_cost_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_flash_regular_units_ty) AS jwn_operational_gmv_flash_regular_units_ty,
  SUM(mtsswaf.jwn_operational_gmv_flash_regular_retail_amt_ty) AS jwn_operational_gmv_flash_regular_retail_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_flash_regular_cost_amt_ty) AS jwn_operational_gmv_flash_regular_cost_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_flash_promo_units_ty) AS jwn_operational_gmv_flash_promo_units_ty,
  SUM(mtsswaf.jwn_operational_gmv_flash_promo_retail_amt_ty) AS jwn_operational_gmv_flash_promo_retail_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_flash_promo_cost_amt_ty) AS jwn_operational_gmv_flash_promo_cost_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_flash_clearance_units_ty) AS jwn_operational_gmv_flash_clearance_units_ty,
  SUM(mtsswaf.jwn_operational_gmv_flash_clearance_retail_amt_ty) AS jwn_operational_gmv_flash_clearance_retail_amt_ty,
  SUM(mtsswaf.jwn_operational_gmv_flash_clearance_cost_amt_ty) AS jwn_operational_gmv_flash_clearance_cost_amt_ty,
  SUM(mtsswaf.jwn_gross_sales_total_units_ty) AS jwn_gross_sales_total_units_ty,
  SUM(mtsswaf.jwn_gross_sales_total_retail_amt_ty) AS jwn_gross_sales_total_retail_amt_ty,
  SUM(mtsswaf.jwn_gross_sales_total_cost_amt_ty) AS jwn_gross_sales_total_cost_amt_ty,
  SUM(mtsswaf.jwn_gross_sales_regular_units_ty) AS jwn_gross_sales_regular_units_ty,
  SUM(mtsswaf.jwn_gross_sales_regular_retail_amt_ty) AS jwn_gross_sales_regular_retail_amt_ty,
  SUM(mtsswaf.jwn_gross_sales_regular_cost_amt_ty) AS jwn_gross_sales_regular_cost_amt_ty,
  SUM(mtsswaf.jwn_gross_sales_promo_units_ty) AS jwn_gross_sales_promo_units_ty,
  SUM(mtsswaf.jwn_gross_sales_promo_retail_amt_ty) AS jwn_gross_sales_promo_retail_amt_ty,
  SUM(mtsswaf.jwn_gross_sales_promo_cost_amt_ty) AS jwn_gross_sales_promo_cost_amt_ty,
  SUM(mtsswaf.jwn_gross_sales_clearance_units_ty) AS jwn_gross_sales_clearance_units_ty,
  SUM(mtsswaf.jwn_gross_sales_clearance_retail_amt_ty) AS jwn_gross_sales_clearance_retail_amt_ty,
  SUM(mtsswaf.jwn_gross_sales_clearance_cost_amt_ty) AS jwn_gross_sales_clearance_cost_amt_ty,
  SUM(mtsswaf.jwn_returns_total_units_ty) AS jwn_returns_total_units_ty,
  SUM(mtsswaf.jwn_returns_total_retail_amt_ty) AS jwn_returns_total_retail_amt_ty,
  SUM(mtsswaf.jwn_returns_total_cost_amt_ty) AS jwn_returns_total_cost_amt_ty,
  SUM(mtsswaf.jwn_returns_regular_units_ty) AS jwn_returns_regular_units_ty,
  SUM(mtsswaf.jwn_returns_regular_retail_amt_ty) AS jwn_returns_regular_retail_amt_ty,
  SUM(mtsswaf.jwn_returns_regular_cost_amt_ty) AS jwn_returns_regular_cost_amt_ty,
  SUM(mtsswaf.jwn_returns_promo_units_ty) AS jwn_returns_promo_units_ty,
  SUM(mtsswaf.jwn_returns_promo_retail_amt_ty) AS jwn_returns_promo_retail_amt_ty,
  SUM(mtsswaf.jwn_returns_promo_cost_amt_ty) AS jwn_returns_promo_cost_amt_ty,
  SUM(mtsswaf.jwn_returns_clearance_units_ty) AS jwn_returns_clearance_units_ty,
  SUM(mtsswaf.jwn_returns_clearance_retail_amt_ty) AS jwn_returns_clearance_retail_amt_ty,
  SUM(mtsswaf.jwn_returns_clearance_cost_amt_ty) AS jwn_returns_clearance_cost_amt_ty,
  SUM(mtsswaf.receipts_total_units_ty) AS receipts_total_units_ty,
  SUM(mtsswaf.receipts_total_retail_amt_ty) AS receipts_total_retail_amt_ty,
  SUM(mtsswaf.receipts_total_cost_amt_ty) AS receipts_total_cost_amt_ty,
  SUM(mtsswaf.receipts_po_units_ty) AS receipts_po_units_ty,
  SUM(mtsswaf.receipts_po_retail_amt_ty) AS receipts_po_retail_amt_ty,
  SUM(mtsswaf.receipts_po_cost_amt_ty) AS receipts_po_cost_amt_ty,
  SUM(mtsswaf.receipts_dropship_units_ty) AS receipts_dropship_units_ty,
  SUM(mtsswaf.receipts_dropship_retail_amt_ty) AS receipts_dropship_retail_amt_ty,
  SUM(mtsswaf.receipts_dropship_cost_amt_ty) AS receipts_dropship_cost_amt_ty,
  SUM(mtsswaf.transfer_in_pack_and_hold_units_ty) AS transfer_in_pack_and_hold_units_ty,
  SUM(mtsswaf.transfer_in_pack_and_hold_retail_amt_ty) AS transfer_in_pack_and_hold_retail_amt_ty,
  SUM(mtsswaf.transfer_in_pack_and_hold_cost_amt_ty) AS transfer_in_pack_and_hold_cost_amt_ty,
  SUM(mtsswaf.transfer_in_reserve_stock_units_ty) AS transfer_in_reserve_stock_units_ty,
  SUM(mtsswaf.transfer_in_reserve_stock_retail_amt_ty) AS transfer_in_reserve_stock_retail_amt_ty,
  SUM(mtsswaf.transfer_in_reserve_stock_cost_amt_ty) AS transfer_in_reserve_stock_cost_amt_ty,
  SUM(mtsswaf.transfer_in_racking_units_ty) AS transfer_in_racking_units_ty,
  SUM(mtsswaf.transfer_in_racking_retail_amt_ty) AS transfer_in_racking_retail_amt_ty,
  SUM(mtsswaf.transfer_in_racking_cost_amt_ty) AS transfer_in_racking_cost_amt_ty,
  SUM(mtsswaf.transfer_out_racking_units_ty) AS transfer_out_racking_units_ty,
  SUM(mtsswaf.transfer_out_racking_retail_amt_ty) AS transfer_out_racking_retail_amt_ty,
  SUM(mtsswaf.transfer_out_racking_cost_amt_ty) AS transfer_out_racking_cost_amt_ty,
  SUM(mtsswaf.transfer_in_return_to_rack_units_ty) AS transfer_in_return_to_rack_units_ty,
  SUM(mtsswaf.transfer_in_return_to_rack_retail_amt_ty) AS transfer_in_return_to_rack_retail_amt_ty,
  SUM(mtsswaf.transfer_in_return_to_rack_cost_amt_ty) AS transfer_in_return_to_rack_cost_amt_ty,
  SUM(mtsswaf.inventory_boh_total_units_ty) AS inventory_boh_total_units_ty,
  SUM(mtsswaf.inventory_boh_total_retail_amt_ty) AS inventory_boh_total_retail_amt_ty,
  SUM(mtsswaf.inventory_boh_total_cost_amt_ty) AS inventory_boh_total_cost_amt_ty,
  SUM(mtsswaf.inventory_boh_regular_units_ty) AS inventory_boh_regular_units_ty,
  SUM(mtsswaf.inventory_boh_regular_retail_amt_ty) AS inventory_boh_regular_retail_amt_ty,
  SUM(mtsswaf.inventory_boh_regular_cost_amt_ty) AS inventory_boh_regular_cost_amt_ty,
  SUM(mtsswaf.inventory_boh_clearance_units_ty) AS inventory_boh_clearance_units_ty,
  SUM(mtsswaf.inventory_boh_clearance_retail_amt_ty) AS inventory_boh_clearance_retail_amt_ty,
  SUM(mtsswaf.inventory_boh_clearance_cost_amt_ty) AS inventory_boh_clearance_cost_amt_ty,
  SUM(mtsswaf.inventory_eoh_total_units_ty) AS inventory_eoh_total_units_ty,
  SUM(mtsswaf.inventory_eoh_total_retail_amt_ty) AS inventory_eoh_total_retail_amt_ty,
  SUM(mtsswaf.inventory_eoh_total_cost_amt_ty) AS inventory_eoh_total_cost_amt_ty,
  SUM(mtsswaf.inventory_eoh_regular_units_ty) AS inventory_eoh_regular_units_ty,
  SUM(mtsswaf.inventory_eoh_regular_retail_amt_ty) AS inventory_eoh_regular_retail_amt_ty,
  SUM(mtsswaf.inventory_eoh_regular_cost_amt_ty) AS inventory_eoh_regular_cost_amt_ty,
  SUM(mtsswaf.inventory_eoh_clearance_units_ty) AS inventory_eoh_clearance_units_ty,
  SUM(mtsswaf.inventory_eoh_clearance_retail_amt_ty) AS inventory_eoh_clearance_retail_amt_ty,
  SUM(mtsswaf.inventory_eoh_clearance_cost_amt_ty) AS inventory_eoh_clearance_cost_amt_ty,
  SUM(mtsswaf.rtv_total_units_ty) AS rtv_total_units_ty,
  SUM(mtsswaf.rtv_total_retail_amt_ty) AS rtv_total_retail_amt_ty,
  SUM(mtsswaf.rtv_total_cost_amt_ty) AS rtv_total_cost_amt_ty,
  SUM(mtsswaf.jwn_demand_total_units_ly) AS jwn_demand_total_units_ly,
  SUM(mtsswaf.jwn_demand_total_retail_amt_ly) AS jwn_demand_total_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_regular_units_ly) AS jwn_demand_regular_units_ly,
  SUM(mtsswaf.jwn_demand_regular_retail_amt_ly) AS jwn_demand_regular_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_promo_units_ly) AS jwn_demand_promo_units_ly,
  SUM(mtsswaf.jwn_demand_promo_retail_amt_ly) AS jwn_demand_promo_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_clearance_units_ly) AS jwn_demand_clearance_units_ly,
  SUM(mtsswaf.jwn_demand_clearance_retail_amt_ly) AS jwn_demand_clearance_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_store_fulfilled_units_ly) AS jwn_demand_store_fulfilled_units_ly,
  SUM(mtsswaf.jwn_demand_store_fulfilled_retail_amt_ly) AS jwn_demand_store_fulfilled_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_store_fulfilled_regular_units_ly) AS jwn_demand_store_fulfilled_regular_units_ly,
  SUM(mtsswaf.jwn_demand_store_fulfilled_regular_retail_amt_ly) AS jwn_demand_store_fulfilled_regular_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_store_fulfilled_promo_units_ly) AS jwn_demand_store_fulfilled_promo_units_ly,
  SUM(mtsswaf.jwn_demand_store_fulfilled_promo_retail_amt_ly) AS jwn_demand_store_fulfilled_promo_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_store_fulfilled_clearance_units_ly) AS jwn_demand_store_fulfilled_clearance_units_ly,
  SUM(mtsswaf.jwn_demand_store_fulfilled_clearance_retail_amt_ly) AS jwn_demand_store_fulfilled_clearance_retail_amt_ly
  ,
  SUM(mtsswaf.jwn_demand_persistent_units_ly) AS jwn_demand_persistent_units_ly,
  SUM(mtsswaf.jwn_demand_persistent_retail_amt_ly) AS jwn_demand_persistent_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_persistent_regular_units_ly) AS jwn_demand_persistent_regular_units_ly,
  SUM(mtsswaf.jwn_demand_persistent_regular_retail_amt_ly) AS jwn_demand_persistent_regular_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_persistent_promo_units_ly) AS jwn_demand_persistent_promo_units_ly,
  SUM(mtsswaf.jwn_demand_persistent_promo_retail_amt_ly) AS jwn_demand_persistent_promo_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_persistent_clearance_units_ly) AS jwn_demand_persistent_clearance_units_ly,
  SUM(mtsswaf.jwn_demand_persistent_clearance_retail_amt_ly) AS jwn_demand_persistent_clearance_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_other_fulfilled_units_ly) AS jwn_demand_other_fulfilled_units_ly,
  SUM(mtsswaf.jwn_demand_other_fulfilled_retail_amt_ly) AS jwn_demand_other_fulfilled_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_other_fulfilled_regular_units_ly) AS jwn_demand_other_fulfilled_regular_units_ly,
  SUM(mtsswaf.jwn_demand_other_fulfilled_regular_retail_amt_ly) AS jwn_demand_other_fulfilled_regular_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_other_fulfilled_promo_units_ly) AS jwn_demand_other_fulfilled_promo_units_ly,
  SUM(mtsswaf.jwn_demand_other_fulfilled_promo_retail_amt_ly) AS jwn_demand_other_fulfilled_promo_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_other_fulfilled_clearance_units_ly) AS jwn_demand_other_fulfilled_clearance_units_ly,
  SUM(mtsswaf.jwn_demand_other_fulfilled_clearance_retail_amt_ly) AS jwn_demand_other_fulfilled_clearance_retail_amt_ly
  ,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_units_ly) AS jwn_demand_fulfillment_center_fulfilled_units_ly,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_retail_amt_ly) AS
  jwn_demand_fulfillment_center_fulfilled_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_regular_units_ly) AS
  jwn_demand_fulfillment_center_fulfilled_regular_units_ly,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_regular_retail_amt_ly) AS
  jwn_demand_fulfillment_center_fulfilled_regular_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_promo_units_ly) AS
  jwn_demand_fulfillment_center_fulfilled_promo_units_ly,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_promo_retail_amt_ly) AS
  jwn_demand_fulfillment_center_fulfilled_promo_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_clearance_units_ly) AS
  jwn_demand_fulfillment_center_fulfilled_clearance_units_ly,
  SUM(mtsswaf.jwn_demand_fulfillment_center_fulfilled_clearance_retail_amt_ly) AS
  jwn_demand_fulfillment_center_fulfilled_clearance_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_flash_units_ly) AS jwn_demand_flash_units_ly,
  SUM(mtsswaf.jwn_demand_flash_retail_amt_ly) AS jwn_demand_flash_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_flash_regular_units_ly) AS jwn_demand_flash_regular_units_ly,
  SUM(mtsswaf.jwn_demand_flash_regular_retail_amt_ly) AS jwn_demand_flash_regular_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_flash_promo_units_ly) AS jwn_demand_flash_promo_units_ly,
  SUM(mtsswaf.jwn_demand_flash_promo_retail_amt_ly) AS jwn_demand_flash_promo_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_flash_clearance_units_ly) AS jwn_demand_flash_clearance_units_ly,
  SUM(mtsswaf.jwn_demand_flash_clearance_retail_amt_ly) AS jwn_demand_flash_clearance_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_units_ly) AS jwn_demand_dropship_fulfilled_units_ly,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_retail_amt_ly) AS jwn_demand_dropship_fulfilled_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_regular_units_ly) AS jwn_demand_dropship_fulfilled_regular_units_ly,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_regular_retail_amt_ly) AS
  jwn_demand_dropship_fulfilled_regular_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_promo_units_ly) AS jwn_demand_dropship_fulfilled_promo_units_ly,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_promo_retail_amt_ly) AS jwn_demand_dropship_fulfilled_promo_retail_amt_ly,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_clearance_units_ly) AS jwn_demand_dropship_fulfilled_clearance_units_ly,
  SUM(mtsswaf.jwn_demand_dropship_fulfilled_clearance_retail_amt_ly) AS
  jwn_demand_dropship_fulfilled_clearance_retail_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_total_units_ly) AS jwn_operational_gmv_total_units_ly,
  SUM(mtsswaf.jwn_operational_gmv_total_retail_amt_ly) AS jwn_operational_gmv_total_retail_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_total_cost_amt_ly) AS jwn_operational_gmv_total_cost_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_regular_units_ly) AS jwn_operational_gmv_regular_units_ly,
  SUM(mtsswaf.jwn_operational_gmv_regular_retail_amt_ly) AS jwn_operational_gmv_regular_retail_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_regular_cost_amt_ly) AS jwn_operational_gmv_regular_cost_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_promo_units_ly) AS jwn_operational_gmv_promo_units_ly,
  SUM(mtsswaf.jwn_operational_gmv_promo_retail_amt_ly) AS jwn_operational_gmv_promo_retail_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_promo_cost_amt_ly) AS jwn_operational_gmv_promo_cost_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_clearance_units_ly) AS jwn_operational_gmv_clearance_units_ly,
  SUM(mtsswaf.jwn_operational_gmv_clearance_retail_amt_ly) AS jwn_operational_gmv_clearance_retail_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_clearance_cost_amt_ly) AS jwn_operational_gmv_clearance_cost_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_persistent_units_ly) AS jwn_operational_gmv_persistent_units_ly,
  SUM(mtsswaf.jwn_operational_gmv_persistent_retail_amt_ly) AS jwn_operational_gmv_persistent_retail_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_persistent_cost_amt_ly) AS jwn_operational_gmv_persistent_cost_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_persistent_regular_units_ly) AS jwn_operational_gmv_persistent_regular_units_ly,
  SUM(mtsswaf.jwn_operational_gmv_persistent_regular_retail_amt_ly) AS
  jwn_operational_gmv_persistent_regular_retail_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_persistent_regular_cost_amt_ly) AS jwn_operational_gmv_persistent_regular_cost_amt_ly
  ,
  SUM(mtsswaf.jwn_operational_gmv_persistent_promo_units_ly) AS jwn_operational_gmv_persistent_promo_units_ly,
  SUM(mtsswaf.jwn_operational_gmv_persistent_promo_retail_amt_ly) AS jwn_operational_gmv_persistent_promo_retail_amt_ly
  ,
  SUM(mtsswaf.jwn_operational_gmv_persistent_promo_cost_amt_ly) AS jwn_operational_gmv_persistent_promo_cost_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_persistent_clearance_units_ly) AS jwn_operational_gmv_persistent_clearance_units_ly,
  SUM(mtsswaf.jwn_operational_gmv_persistent_clearance_retail_amt_ly) AS
  jwn_operational_gmv_persistent_clearance_retail_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_persistent_clearance_cost_amt_ly) AS
  jwn_operational_gmv_persistent_clearance_cost_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_flash_units_ly) AS jwn_operational_gmv_flash_units_ly,
  SUM(mtsswaf.jwn_operational_gmv_flash_retail_amt_ly) AS jwn_operational_gmv_flash_retail_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_flash_cost_amt_ly) AS jwn_operational_gmv_flash_cost_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_flash_regular_units_ly) AS jwn_operational_gmv_flash_regular_units_ly,
  SUM(mtsswaf.jwn_operational_gmv_flash_regular_retail_amt_ly) AS jwn_operational_gmv_flash_regular_retail_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_flash_regular_cost_amt_ly) AS jwn_operational_gmv_flash_regular_cost_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_flash_promo_units_ly) AS jwn_operational_gmv_flash_promo_units_ly,
  SUM(mtsswaf.jwn_operational_gmv_flash_promo_retail_amt_ly) AS jwn_operational_gmv_flash_promo_retail_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_flash_promo_cost_amt_ly) AS jwn_operational_gmv_flash_promo_cost_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_flash_clearance_units_ly) AS jwn_operational_gmv_flash_clearance_units_ly,
  SUM(mtsswaf.jwn_operational_gmv_flash_clearance_retail_amt_ly) AS jwn_operational_gmv_flash_clearance_retail_amt_ly,
  SUM(mtsswaf.jwn_operational_gmv_flash_clearance_cost_amt_ly) AS jwn_operational_gmv_flash_clearance_cost_amt_ly,
  SUM(mtsswaf.jwn_gross_sales_total_units_ly) AS jwn_gross_sales_total_units_ly,
  SUM(mtsswaf.jwn_gross_sales_total_retail_amt_ly) AS jwn_gross_sales_total_retail_amt_ly,
  SUM(mtsswaf.jwn_gross_sales_total_cost_amt_ly) AS jwn_gross_sales_total_cost_amt_ly,
  SUM(mtsswaf.jwn_gross_sales_regular_units_ly) AS jwn_gross_sales_regular_units_ly,
  SUM(mtsswaf.jwn_gross_sales_regular_retail_amt_ly) AS jwn_gross_sales_regular_retail_amt_ly,
  SUM(mtsswaf.jwn_gross_sales_regular_cost_amt_ly) AS jwn_gross_sales_regular_cost_amt_ly,
  SUM(mtsswaf.jwn_gross_sales_promo_units_ly) AS jwn_gross_sales_promo_units_ly,
  SUM(mtsswaf.jwn_gross_sales_promo_retail_amt_ly) AS jwn_gross_sales_promo_retail_amt_ly,
  SUM(mtsswaf.jwn_gross_sales_promo_cost_amt_ly) AS jwn_gross_sales_promo_cost_amt_ly,
  SUM(mtsswaf.jwn_gross_sales_clearance_units_ly) AS jwn_gross_sales_clearance_units_ly,
  SUM(mtsswaf.jwn_gross_sales_clearance_retail_amt_ly) AS jwn_gross_sales_clearance_retail_amt_ly,
  SUM(mtsswaf.jwn_gross_sales_clearance_cost_amt_ly) AS jwn_gross_sales_clearance_cost_amt_ly,
  SUM(mtsswaf.jwn_returns_total_units_ly) AS jwn_returns_total_units_ly,
  SUM(mtsswaf.jwn_returns_total_retail_amt_ly) AS jwn_returns_total_retail_amt_ly,
  SUM(mtsswaf.jwn_returns_total_cost_amt_ly) AS jwn_returns_total_cost_amt_ly,
  SUM(mtsswaf.jwn_returns_regular_units_ly) AS jwn_returns_regular_units_ly,
  SUM(mtsswaf.jwn_returns_regular_retail_amt_ly) AS jwn_returns_regular_retail_amt_ly,
  SUM(mtsswaf.jwn_returns_regular_cost_amt_ly) AS jwn_returns_regular_cost_amt_ly,
  SUM(mtsswaf.jwn_returns_promo_units_ly) AS jwn_returns_promo_units_ly,
  SUM(mtsswaf.jwn_returns_promo_retail_amt_ly) AS jwn_returns_promo_retail_amt_ly,
  SUM(mtsswaf.jwn_returns_promo_cost_amt_ly) AS jwn_returns_promo_cost_amt_ly,
  SUM(mtsswaf.jwn_returns_clearance_units_ly) AS jwn_returns_clearance_units_ly,
  SUM(mtsswaf.jwn_returns_clearance_retail_amt_ly) AS jwn_returns_clearance_retail_amt_ly,
  SUM(mtsswaf.jwn_returns_clearance_cost_amt_ly) AS jwn_returns_clearance_cost_amt_ly,
  SUM(mtsswaf.receipts_total_units_ly) AS receipts_total_units_ly,
  SUM(mtsswaf.receipts_total_retail_amt_ly) AS receipts_total_retail_amt_ly,
  SUM(mtsswaf.receipts_total_cost_amt_ly) AS receipts_total_cost_amt_ly,
  SUM(mtsswaf.receipts_po_units_ly) AS receipts_po_units_ly,
  SUM(mtsswaf.receipts_po_retail_amt_ly) AS receipts_po_retail_amt_ly,
  SUM(mtsswaf.receipts_po_cost_amt_ly) AS receipts_po_cost_amt_ly,
  SUM(mtsswaf.receipts_dropship_units_ly) AS receipts_dropship_units_ly,
  SUM(mtsswaf.receipts_dropship_retail_amt_ly) AS receipts_dropship_retail_amt_ly,
  SUM(mtsswaf.receipts_dropship_cost_amt_ly) AS receipts_dropship_cost_amt_ly,
  SUM(mtsswaf.transfer_in_pack_and_hold_units_ly) AS transfer_in_pack_and_hold_units_ly,
  SUM(mtsswaf.transfer_in_pack_and_hold_retail_amt_ly) AS transfer_in_pack_and_hold_retail_amt_ly,
  SUM(mtsswaf.transfer_in_pack_and_hold_cost_amt_ly) AS transfer_in_pack_and_hold_cost_amt_ly,
  SUM(mtsswaf.transfer_in_reserve_stock_units_ly) AS transfer_in_reserve_stock_units_ly,
  SUM(mtsswaf.transfer_in_reserve_stock_retail_amt_ly) AS transfer_in_reserve_stock_retail_amt_ly,
  SUM(mtsswaf.transfer_in_reserve_stock_cost_amt_ly) AS transfer_in_reserve_stock_cost_amt_ly,
  SUM(mtsswaf.transfer_in_racking_units_ly) AS transfer_in_racking_units_ly,
  SUM(mtsswaf.transfer_in_racking_retail_amt_ly) AS transfer_in_racking_retail_amt_ly,
  SUM(mtsswaf.transfer_in_racking_cost_amt_ly) AS transfer_in_racking_cost_amt_ly,
  SUM(mtsswaf.transfer_out_racking_units_ly) AS transfer_out_racking_units_ly,
  SUM(mtsswaf.transfer_out_racking_retail_amt_ly) AS transfer_out_racking_retail_amt_ly,
  SUM(mtsswaf.transfer_out_racking_cost_amt_ly) AS transfer_out_racking_cost_amt_ly,
  SUM(mtsswaf.transfer_in_return_to_rack_units_ly) AS transfer_in_return_to_rack_units_ly,
  SUM(mtsswaf.transfer_in_return_to_rack_retail_amt_ly) AS transfer_in_return_to_rack_retail_amt_ly,
  SUM(mtsswaf.transfer_in_return_to_rack_cost_amt_ly) AS transfer_in_return_to_rack_cost_amt_ly,
  SUM(mtsswaf.inventory_boh_total_units_ly) AS inventory_boh_total_units_ly,
  SUM(mtsswaf.inventory_boh_total_retail_amt_ly) AS inventory_boh_total_retail_amt_ly,
  SUM(mtsswaf.inventory_boh_total_cost_amt_ly) AS inventory_boh_total_cost_amt_ly,
  SUM(mtsswaf.inventory_boh_regular_units_ly) AS inventory_boh_regular_units_ly,
  SUM(mtsswaf.inventory_boh_regular_retail_amt_ly) AS inventory_boh_regular_retail_amt_ly,
  SUM(mtsswaf.inventory_boh_regular_cost_amt_ly) AS inventory_boh_regular_cost_amt_ly,
  SUM(mtsswaf.inventory_boh_clearance_units_ly) AS inventory_boh_clearance_units_ly,
  SUM(mtsswaf.inventory_boh_clearance_retail_amt_ly) AS inventory_boh_clearance_retail_amt_ly,
  SUM(mtsswaf.inventory_boh_clearance_cost_amt_ly) AS inventory_boh_clearance_cost_amt_ly,
  SUM(mtsswaf.inventory_eoh_total_units_ly) AS inventory_eoh_total_units_ly,
  SUM(mtsswaf.inventory_eoh_total_retail_amt_ly) AS inventory_eoh_total_retail_amt_ly,
  SUM(mtsswaf.inventory_eoh_total_cost_amt_ly) AS inventory_eoh_total_cost_amt_ly,
  SUM(mtsswaf.inventory_eoh_regular_units_ly) AS inventory_eoh_regular_units_ly,
  SUM(mtsswaf.inventory_eoh_regular_retail_amt_ly) AS inventory_eoh_regular_retail_amt_ly,
  SUM(mtsswaf.inventory_eoh_regular_cost_amt_ly) AS inventory_eoh_regular_cost_amt_ly,
  SUM(mtsswaf.inventory_eoh_clearance_units_ly) AS inventory_eoh_clearance_units_ly,
  SUM(mtsswaf.inventory_eoh_clearance_retail_amt_ly) AS inventory_eoh_clearance_retail_amt_ly,
  SUM(mtsswaf.inventory_eoh_clearance_cost_amt_ly) AS inventory_eoh_clearance_cost_amt_ly,
  SUM(mtsswaf.rtv_total_units_ly) AS rtv_total_units_ly,
  SUM(mtsswaf.rtv_total_retail_amt_ly) AS rtv_total_retail_amt_ly,
  SUM(mtsswaf.rtv_total_cost_amt_ly) AS rtv_total_cost_amt_ly,
  SUM(mtsswaf.mos_total_cost_amt_ty) AS mos_total_cost_amt_ty,
  SUM(mtsswaf.mos_regular_cost_amt_ty) AS mos_regular_cost_amt_ty,
  SUM(mtsswaf.mos_clearance_cost_amt_ty) AS mos_clearance_cost_amt_ty,
  SUM(mtsswaf.mos_total_units_ty) AS mos_total_units_ty,
  SUM(mtsswaf.mos_regular_units_ty) AS mos_regular_units_ty,
  SUM(mtsswaf.mos_clearance_units_ty) AS mos_clearance_units_ty,
  SUM(mtsswaf.mos_total_retail_amt_ty) AS mos_total_retail_amt_ty,
  SUM(mtsswaf.mos_regular_retail_amt_ty) AS mos_regular_retail_amt_ty,
  SUM(mtsswaf.mos_clearance_retail_amt_ty) AS mos_clearance_retail_amt_ty,
  SUM(mtsswaf.mos_total_cost_amt_ly) AS mos_total_cost_amt_ly,
  SUM(mtsswaf.mos_regular_cost_amt_ly) AS mos_regular_cost_amt_ly,
  SUM(mtsswaf.mos_clearance_cost_amt_ly) AS mos_clearance_cost_amt_ly,
  SUM(mtsswaf.mos_total_units_ly) AS mos_total_units_ly,
  SUM(mtsswaf.mos_regular_units_ly) AS mos_regular_units_ly,
  SUM(mtsswaf.mos_clearance_units_ly) AS mos_clearance_units_ly,
  SUM(mtsswaf.mos_total_retail_amt_ly) AS mos_total_retail_amt_ly,
  SUM(mtsswaf.mos_regular_retail_amt_ly) AS mos_regular_retail_amt_ly,
  SUM(mtsswaf.mos_clearance_retail_amt_ly) AS mos_clearance_retail_amt_ly,
  SUM(mtsswaf.receipts_regular_retail_amt_ty) AS receipts_regular_retail_amt_ty,
  SUM(mtsswaf.receipts_regular_units_ty) AS receipts_regular_units_ty,
  SUM(mtsswaf.receipts_regular_cost_amt_ty) AS receipts_regular_cost_amt_ty,
  SUM(mtsswaf.receipts_clearance_retail_amt_ty) AS receipts_clearance_retail_amt_ty,
  SUM(mtsswaf.receipts_clearance_units_ty) AS receipts_clearance_units_ty,
  SUM(mtsswaf.receipts_clearance_cost_amt_ty) AS receipts_clearance_cost_amt_ty,
  SUM(mtsswaf.receipts_crossdock_regular_retail_amt_ty) AS receipts_crossdock_regular_retail_amt_ty,
  SUM(mtsswaf.receipts_crossdock_regular_units_ty) AS receipts_crossdock_regular_units_ty,
  SUM(mtsswaf.receipts_crossdock_regular_cost_amt_ty) AS receipts_crossdock_regular_cost_amt_ty,
  SUM(mtsswaf.receipts_crossdock_clearance_retail_amt_ty) AS receipts_crossdock_clearance_retail_amt_ty,
  SUM(mtsswaf.receipts_crossdock_clearance_units_ty) AS receipts_crossdock_clearance_units_ty,
  SUM(mtsswaf.receipts_crossdock_clearance_cost_amt_ty) AS receipts_crossdock_clearance_cost_amt_ty,
  SUM(mtsswaf.receipts_regular_retail_amt_ly) AS receipts_regular_retail_amt_ly,
  SUM(mtsswaf.receipts_regular_units_ly) AS receipts_regular_units_ly,
  SUM(mtsswaf.receipts_regular_cost_amt_ly) AS receipts_regular_cost_amt_ly,
  SUM(mtsswaf.receipts_clearance_retail_amt_ly) AS receipts_clearance_retail_amt_ly,
  SUM(mtsswaf.receipts_clearance_units_ly) AS receipts_clearance_units_ly,
  SUM(mtsswaf.receipts_clearance_cost_amt_ly) AS receipts_clearance_cost_amt_ly,
  SUM(mtsswaf.receipts_crossdock_regular_retail_amt_ly) AS receipts_crossdock_regular_retail_amt_ly,
  SUM(mtsswaf.receipts_crossdock_regular_units_ly) AS receipts_crossdock_regular_units_ly,
  SUM(mtsswaf.receipts_crossdock_regular_cost_amt_ly) AS receipts_crossdock_regular_cost_amt_ly,
  SUM(mtsswaf.receipts_crossdock_clearance_retail_amt_ly) AS receipts_crossdock_clearance_retail_amt_ly,
  SUM(mtsswaf.receipts_crossdock_clearance_units_ly) AS receipts_crossdock_clearance_units_ly,
  SUM(mtsswaf.receipts_crossdock_clearance_cost_amt_ly) AS receipts_crossdock_clearance_cost_amt_ly,
  SUM(mtsswaf.transfer_in_racking_regular_cost_amt_ty) AS transfer_in_racking_regular_cost_amt_ty,
  SUM(mtsswaf.transfer_in_racking_clearance_cost_amt_ty) AS transfer_in_racking_clearance_cost_amt_ty,
  SUM(mtsswaf.transfer_in_racking_regular_units_ty) AS transfer_in_racking_regular_units_ty,
  SUM(mtsswaf.transfer_in_racking_clearance_units_ty) AS transfer_in_racking_clearance_units_ty,
  SUM(mtsswaf.transfer_out_racking_regular_cost_amt_ty) AS transfer_out_racking_regular_cost_amt_ty,
  SUM(mtsswaf.transfer_out_racking_clearance_cost_amt_ty) AS transfer_out_racking_clearance_cost_amt_ty,
  SUM(mtsswaf.transfer_out_racking_regular_units_ty) AS transfer_out_racking_regular_units_ty,
  SUM(mtsswaf.transfer_out_racking_clearance_units_ty) AS transfer_out_racking_clearance_units_ty,
  SUM(mtsswaf.transfer_in_pack_and_hold_regular_cost_amt_ty) AS transfer_in_pack_and_hold_regular_cost_amt_ty,
  SUM(mtsswaf.transfer_in_pack_and_hold_clearance_cost_amt_ty) AS transfer_in_pack_and_hold_clearance_cost_amt_ty,
  SUM(mtsswaf.transfer_in_pack_and_hold_regular_units_ty) AS transfer_in_pack_and_hold_regular_units_ty,
  SUM(mtsswaf.transfer_in_pack_and_hold_clearance_units_ty) AS transfer_in_pack_and_hold_clearance_units_ty,
  SUM(mtsswaf.transfer_out_pack_and_hold_cost_amt_ty) AS transfer_out_pack_and_hold_cost_amt_ty,
  SUM(mtsswaf.transfer_out_pack_and_hold_regular_cost_amt_ty) AS transfer_out_pack_and_hold_regular_cost_amt_ty,
  SUM(mtsswaf.transfer_out_pack_and_hold_clearance_cost_amt_ty) AS transfer_out_pack_and_hold_clearance_cost_amt_ty,
  SUM(mtsswaf.transfer_out_pack_and_hold_units_ty) AS transfer_out_pack_and_hold_units_ty,
  SUM(mtsswaf.transfer_out_pack_and_hold_regular_units_ty) AS transfer_out_pack_and_hold_regular_units_ty,
  SUM(mtsswaf.transfer_out_pack_and_hold_clearance_units_ty) AS transfer_out_pack_and_hold_clearance_units_ty,
  SUM(mtsswaf.transfer_in_reserve_stock_regular_cost_amt_ty) AS transfer_in_reserve_stock_regular_cost_amt_ty,
  SUM(mtsswaf.transfer_in_reserve_stock_clearance_cost_amt_ty) AS transfer_in_reserve_stock_clearance_cost_amt_ty,
  SUM(mtsswaf.transfer_in_reserve_stock_regular_units_ty) AS transfer_in_reserve_stock_regular_units_ty,
  SUM(mtsswaf.transfer_in_reserve_stock_clearance_units_ty) AS transfer_in_reserve_stock_clearance_units_ty,
  SUM(mtsswaf.transfer_out_reserve_stock_cost_amt_ty) AS transfer_out_reserve_stock_cost_amt_ty,
  SUM(mtsswaf.transfer_out_reserve_stock_regular_cost_amt_ty) AS transfer_out_reserve_stock_regular_cost_amt_ty,
  SUM(mtsswaf.transfer_out_reserve_stock_clearance_cost_amt_ty) AS transfer_out_reserve_stock_clearance_cost_amt_ty,
  SUM(mtsswaf.transfer_out_reserve_stock_units_ty) AS transfer_out_reserve_stock_units_ty,
  SUM(mtsswaf.transfer_out_reserve_stock_regular_units_ty) AS transfer_out_reserve_stock_regular_units_ty,
  SUM(mtsswaf.transfer_out_reserve_stock_clearance_units_ty) AS transfer_out_reserve_stock_clearance_units_ty,
  SUM(mtsswaf.transfer_in_racking_regular_cost_amt_ly) AS transfer_in_racking_regular_cost_amt_ly,
  SUM(mtsswaf.transfer_in_racking_clearance_cost_amt_ly) AS transfer_in_racking_clearance_cost_amt_ly,
  SUM(mtsswaf.transfer_in_racking_regular_units_ly) AS transfer_in_racking_regular_units_ly,
  SUM(mtsswaf.transfer_in_racking_clearance_units_ly) AS transfer_in_racking_clearance_units_ly,
  SUM(mtsswaf.transfer_out_racking_regular_cost_amt_ly) AS transfer_out_racking_regular_cost_amt_ly,
  SUM(mtsswaf.transfer_out_racking_clearance_cost_amt_ly) AS transfer_out_racking_clearance_cost_amt_ly,
  SUM(mtsswaf.transfer_out_racking_regular_units_ly) AS transfer_out_racking_regular_units_ly,
  SUM(mtsswaf.transfer_out_racking_clearance_units_ly) AS transfer_out_racking_clearance_units_ly,
  SUM(mtsswaf.transfer_in_pack_and_hold_regular_cost_amt_ly) AS transfer_in_pack_and_hold_regular_cost_amt_ly,
  SUM(mtsswaf.transfer_in_pack_and_hold_clearance_cost_amt_ly) AS transfer_in_pack_and_hold_clearance_cost_amt_ly,
  SUM(mtsswaf.transfer_in_pack_and_hold_regular_units_ly) AS transfer_in_pack_and_hold_regular_units_ly,
  SUM(mtsswaf.transfer_in_pack_and_hold_clearance_units_ly) AS transfer_in_pack_and_hold_clearance_units_ly,
  SUM(mtsswaf.transfer_out_pack_and_hold_cost_amt_ly) AS transfer_out_pack_and_hold_cost_amt_ly,
  SUM(mtsswaf.transfer_out_pack_and_hold_regular_cost_amt_ly) AS transfer_out_pack_and_hold_regular_cost_amt_ly,
  SUM(mtsswaf.transfer_out_pack_and_hold_clearance_cost_amt_ly) AS transfer_out_pack_and_hold_clearance_cost_amt_ly,
  SUM(mtsswaf.transfer_out_pack_and_hold_units_ly) AS transfer_out_pack_and_hold_units_ly,
  SUM(mtsswaf.transfer_out_pack_and_hold_regular_units_ly) AS transfer_out_pack_and_hold_regular_units_ly,
  SUM(mtsswaf.transfer_out_pack_and_hold_clearance_units_ly) AS transfer_out_pack_and_hold_clearance_units_ly,
  SUM(mtsswaf.transfer_in_reserve_stock_regular_cost_amt_ly) AS transfer_in_reserve_stock_regular_cost_amt_ly,
  SUM(mtsswaf.transfer_in_reserve_stock_clearance_cost_amt_ly) AS transfer_in_reserve_stock_clearance_cost_amt_ly,
  SUM(mtsswaf.transfer_in_reserve_stock_regular_units_ly) AS transfer_in_reserve_stock_regular_units_ly,
  SUM(mtsswaf.transfer_in_reserve_stock_clearance_units_ly) AS transfer_in_reserve_stock_clearance_units_ly,
  SUM(mtsswaf.transfer_out_reserve_stock_cost_amt_ly) AS transfer_out_reserve_stock_cost_amt_ly,
  SUM(mtsswaf.transfer_out_reserve_stock_regular_cost_amt_ly) AS transfer_out_reserve_stock_regular_cost_amt_ly,
  SUM(mtsswaf.transfer_out_reserve_stock_clearance_cost_amt_ly) AS transfer_out_reserve_stock_clearance_cost_amt_ly,
  SUM(mtsswaf.transfer_out_reserve_stock_units_ly) AS transfer_out_reserve_stock_units_ly,
  SUM(mtsswaf.transfer_out_reserve_stock_regular_units_ly) AS transfer_out_reserve_stock_regular_units_ly,
  SUM(mtsswaf.transfer_out_reserve_stock_clearance_units_ly) AS transfer_out_reserve_stock_clearance_units_ly,
  SUM(mtsswaf.inventory_eoh_in_transit_regular_units_ty) AS inventory_eoh_in_transit_regular_units_ty,
  SUM(mtsswaf.inventory_eoh_in_transit_regular_cost_amt_ty) AS inventory_eoh_in_transit_regular_cost_amt_ty,
  SUM(mtsswaf.inventory_eoh_in_transit_regular_retail_amt_ty) AS inventory_eoh_in_transit_regular_retail_amt_ty,
  SUM(mtsswaf.inventory_eoh_in_transit_clearance_units_ty) AS inventory_eoh_in_transit_clearance_units_ty,
  SUM(mtsswaf.inventory_eoh_in_transit_clearance_cost_amt_ty) AS inventory_eoh_in_transit_clearance_cost_amt_ty,
  SUM(mtsswaf.inventory_eoh_in_transit_clearance_retail_amt_ty) AS inventory_eoh_in_transit_clearance_retail_amt_ty,
  SUM(mtsswaf.inventory_eoh_in_transit_total_units_ty) AS inventory_eoh_in_transit_total_units_ty,
  SUM(mtsswaf.inventory_eoh_in_transit_total_cost_amt_ty) AS inventory_eoh_in_transit_total_cost_amt_ty,
  SUM(mtsswaf.inventory_eoh_in_transit_total_retail_amt_ty) AS inventory_eoh_in_transit_total_retail_amt_ty,
  SUM(mtsswaf.inventory_boh_in_transit_regular_units_ty) AS inventory_boh_in_transit_regular_units_ty,
  SUM(mtsswaf.inventory_boh_in_transit_regular_cost_amt_ty) AS inventory_boh_in_transit_regular_cost_amt_ty,
  SUM(mtsswaf.inventory_boh_in_transit_regular_retail_amt_ty) AS inventory_boh_in_transit_regular_retail_amt_ty,
  SUM(mtsswaf.inventory_boh_in_transit_clearance_units_ty) AS inventory_boh_in_transit_clearance_units_ty,
  SUM(mtsswaf.inventory_boh_in_transit_clearance_cost_amt_ty) AS inventory_boh_in_transit_clearance_cost_amt_ty,
  SUM(mtsswaf.inventory_boh_in_transit_clearance_retail_amt_ty) AS inventory_boh_in_transit_clearance_retail_amt_ty,
  SUM(mtsswaf.inventory_boh_in_transit_total_units_ty) AS inventory_boh_in_transit_total_units_ty,
  SUM(mtsswaf.inventory_boh_in_transit_total_cost_amt_ty) AS inventory_boh_in_transit_total_cost_amt_ty,
  SUM(mtsswaf.inventory_boh_in_transit_total_retail_amt_ty) AS inventory_boh_in_transit_total_retail_amt_ty,
  SUM(mtsswaf.inventory_eoh_in_transit_regular_units_ly) AS inventory_eoh_in_transit_regular_units_ly,
  SUM(mtsswaf.inventory_eoh_in_transit_regular_cost_amt_ly) AS inventory_eoh_in_transit_regular_cost_amt_ly,
  SUM(mtsswaf.inventory_eoh_in_transit_regular_retail_amt_ly) AS inventory_eoh_in_transit_regular_retail_amt_ly,
  SUM(mtsswaf.inventory_eoh_in_transit_clearance_units_ly) AS inventory_eoh_in_transit_clearance_units_ly,
  SUM(mtsswaf.inventory_eoh_in_transit_clearance_cost_amt_ly) AS inventory_eoh_in_transit_clearance_cost_amt_ly,
  SUM(mtsswaf.inventory_eoh_in_transit_clearance_retail_amt_ly) AS inventory_eoh_in_transit_clearance_retail_amt_ly,
  SUM(mtsswaf.inventory_eoh_in_transit_total_units_ly) AS inventory_eoh_in_transit_total_units_ly,
  SUM(mtsswaf.inventory_eoh_in_transit_total_cost_amt_ly) AS inventory_eoh_in_transit_total_cost_amt_ly,
  SUM(mtsswaf.inventory_eoh_in_transit_total_retail_amt_ly) AS inventory_eoh_in_transit_total_retail_amt_ly,
  SUM(mtsswaf.inventory_boh_in_transit_regular_units_ly) AS inventory_boh_in_transit_regular_units_ly,
  SUM(mtsswaf.inventory_boh_in_transit_regular_cost_amt_ly) AS inventory_boh_in_transit_regular_cost_amt_ly,
  SUM(mtsswaf.inventory_boh_in_transit_regular_retail_amt_ly) AS inventory_boh_in_transit_regular_retail_amt_ly,
  SUM(mtsswaf.inventory_boh_in_transit_clearance_units_ly) AS inventory_boh_in_transit_clearance_units_ly,
  SUM(mtsswaf.inventory_boh_in_transit_clearance_cost_amt_ly) AS inventory_boh_in_transit_clearance_cost_amt_ly,
  SUM(mtsswaf.inventory_boh_in_transit_clearance_retail_amt_ly) AS inventory_boh_in_transit_clearance_retail_amt_ly,
  SUM(mtsswaf.inventory_boh_in_transit_total_units_ly) AS inventory_boh_in_transit_total_units_ly,
  SUM(mtsswaf.inventory_boh_in_transit_total_cost_amt_ly) AS inventory_boh_in_transit_total_cost_amt_ly,
  SUM(mtsswaf.inventory_boh_in_transit_total_retail_amt_ly) AS inventory_boh_in_transit_total_retail_amt_ly,
  CAST(FORMAT_TIMESTAMP('%F %H:%M:%S', CURRENT_DATETIME('PST8PDT')) AS DATETIME) AS dw_sys_load_tmstp,
  CURRENT_DATE('PST8PDT') AS dw_batch_date
 FROM `{{params.gcp_project_id}}`.{{params.dbenv}}_nap_base_vws.merch_transaction_sbclass_store_week_agg_fact AS mtsswaf
  LEFT JOIN `{{params.gcp_project_id}}`.{{params.dbenv}}_nap_base_vws.org_channel_country_banner_dim AS occbd ON mtsswaf.channel_num = occbd.channel_num
  LEFT JOIN `{{params.gcp_project_id}}`.{{params.dbenv}}_nap_vws.merch_week_cal_454_vw AS cal ON mtsswaf.week_num = cal.week_idnt
  LEFT JOIN `{{params.gcp_project_id}}`.{{params.dbenv}}_nap_base_vws.department_dim AS dept ON mtsswaf.dept_num = dept.dept_num
 WHERE mtsswaf.week_num IN (SELECT rebuild_week_num
    FROM `{{params.gcp_project_id}}`.{{params.dbenv}}_nap_base_vws.merch_nap_aggregate_rebuild_lkup
    WHERE LOWER(process_status_ind) = LOWER('N')
     AND LOWER(config_key) = LOWER('MERCH_TRAN_DEPT_CHANNEL_WEEK_REBUILD_WEEKS')
    QUALIFY (ROW_NUMBER() OVER (ORDER BY rebuild_week_num)) <= 40)
 GROUP BY mtsswaf.channel_num,
  banner_num,
  channel_country,
  department_num,
  department_desc,
  subdivision_num,
  subdivision_desc,
  division_num,
  division_desc,
  week_num,
  month_num,
  cal.month_label,
  quarter_num,
  halfyear_num,
  year_num);

EXCEPTION WHEN ERROR THEN
SET _ERROR_CODE  =  1;
SET _ERROR_MESSAGE  =  @@error.message;
END;
--ET;
BEGIN
SET _ERROR_CODE  =  0;

UPDATE `{{params.gcp_project_id}}`.{{params.dbenv}}_nap_utl.merch_nap_aggregate_rebuild_lkup SET
    process_status_ind = 'Y',
    dw_sys_updt_tmstp = CAST(FORMAT_TIMESTAMP('%F %H:%M:%S', CURRENT_DATETIME('PST8PDT')) AS DATETIME)
WHERE rebuild_week_num IN (SELECT rebuild_week_num
            FROM `{{params.gcp_project_id}}`.{{params.dbenv}}_nap_base_vws.merch_nap_aggregate_rebuild_lkup
            WHERE LOWER(process_status_ind) = LOWER('N') AND LOWER(config_key) = LOWER('MERCH_TRAN_DEPT_CHANNEL_WEEK_REBUILD_WEEKS')
            QUALIFY (ROW_NUMBER() OVER (ORDER BY rebuild_week_num)) <= 40) AND LOWER(config_key) = LOWER('MERCH_TRAN_DEPT_CHANNEL_WEEK_REBUILD_WEEKS');
EXCEPTION WHEN ERROR THEN
SET _ERROR_CODE  =  1;
SET _ERROR_MESSAGE  =  @@error.message;
END;

/*SET QUERY_BAND = NONE FOR SESSION;*/

END;