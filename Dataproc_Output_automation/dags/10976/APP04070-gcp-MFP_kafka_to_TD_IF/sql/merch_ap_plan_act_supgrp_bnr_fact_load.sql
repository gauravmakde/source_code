TRUNCATE TABLE
  `{{params.gcp_project_id}}`.{{params.dbenv}}_nap_fct.merch_ap_plan_actual_suppgrp_banner_fact;

INSERT INTO
  `{{params.gcp_project_id}}`.{{params.dbenv}}_nap_fct.merch_ap_plan_actual_suppgrp_banner_fact (supplier_group,
    dept_num,
    banner_num,
    channel_country,
    month_num,
    fiscal_year_num,
    actual_net_sales_total_retail_amount,
    actual_net_sales_regular_retail_amount,
    actual_net_sales_promo_retail_amount,
    actual_net_sales_clearance_retail_amount,
    planned_net_sales_total_retail_amount,
    actual_net_sales_regular_cost_amount,
    actual_net_sales_promo_cost_amount,
    actual_net_sales_clearance_cost_amount,
    actual_net_sales_total_cost_amount,
    planned_net_sales_total_cost_amount,
    actual_receipts_total_retail_amount,
    actual_receipts_total_cost_amount,
    actual_vendor_funds_total_cost_amount,
    actual_disc_terms_total_cost_amount,
    actual_mos_total_cost_amount,
    actual_net_sales_regular_units,
    actual_net_sales_promo_units,
    actual_net_sales_clearance_units,
    actual_net_sales_total_units,
    actual_receipts_regular_retail_amount,
    actual_receipts_clearance_retail_amount,
    actual_receipts_regular_cost_amount,
    actual_receipts_clearance_cost_amount,
    actual_receipts_regular_units,
    actual_receipts_clearance_units,
    actual_receipts_total_units,
    actual_onorder_regular_retail_amount,
    actual_onorder_clearance_retail_amount,
    actual_onorder_total_retail_amount,
    actual_onorder_regular_cost_amount,
    actual_onorder_clearance_cost_amount,
    actual_onorder_total_cost_amount,
    actual_onorder_regular_units,
    actual_onorder_clearance_units,
    actual_onorder_total_units,
    actual_inv_bop_regular_retail_amount,
    actual_inv_bop_clearance_retail_amount,
    actual_inv_bop_total_retail_amount,
    actual_inv_bop_regular_cost_amount,
    actual_inv_bop_clearance_cost_amount,
    actual_inv_bop_total_cost_amount,
    actual_inv_bop_regular_units,
    actual_inv_bop_clearance_units,
    actual_inv_bop_total_units,
    actual_inv_eop_regular_retail_amount,
    actual_inv_eop_clearance_retail_amount,
    actual_inv_eop_total_retail_amount,
    actual_inv_eop_regular_cost_amount,
    actual_inv_eop_clearance_cost_amount,
    actual_inv_eop_total_cost_amount,
    actual_inv_eop_regular_units,
    actual_inv_eop_clearance_units,
    actual_inv_eop_total_units,
    actual_transfer_in_total_retail_amount,
    actual_transfer_in_total_cost_amount,
    actual_transfer_in_total_units,
    actual_transfer_out_total_retail_amount,
    actual_transfer_out_total_cost_amount,
    actual_transfer_out_total_units,
    actual_transfer_in_racking_retail_amount,
    actual_transfer_in_racking_cost_amount,
    actual_transfer_in_racking_units,
    actual_transfer_out_racking_retail_amount,
    actual_transfer_out_racking_cost_amount,
    actual_transfer_out_racking_units,
    actual_rtv_total_cost_amount,
    actual_rtv_total_units,
    planned_net_sales_total_units,
    planned_receipts_total_retail_amount,
    planned_receipts_total_cost_amount,
    planned_receipts_total_units,
    planned_inv_total_retail_amount,
    planned_inv_total_cost_amount,
    planned_inv_total_units,
    planned_inv_bop_total_units,
    planned_inv_bop_total_cost_amount,
    planned_rack_transfer_cost_amount,
    planned_rack_transfer_units,
    planned_rtv_total_cost_amount,
    planned_rtv_total_units,
    dw_batch_date,
    dw_sys_load_tmstp)
SELECT
  i01.supplier_group,
  i01.dept_num,
  i01.banner_num,
  i01.channel_country,
  i01.month_num,
  i01.fiscal_year_num,
  SUM(i01.actual_net_sales_total_retail_amount),
  SUM(i01.actual_net_sales_regular_retail_amount),
  SUM(i01.actual_net_sales_promo_retail_amount),
  SUM(i01.actual_net_sales_clearance_retail_amount),
  SUM(i01.planned_net_sales_total_retail_amount),
  SUM(i01.actual_net_sales_regular_cost_amount),
  SUM(i01.actual_net_sales_promo_cost_amount),
  SUM(i01.actual_net_sales_clearance_cost_amount),
  SUM(i01.actual_net_sales_total_cost_amount),
  SUM(i01.planned_net_sales_total_cost_amount),
  SUM(i01.actual_receipts_total_retail_amount),
  SUM(i01.actual_receipts_total_cost_amount),
  SUM(i01.actual_vendor_funds_total_cost_amount),
  SUM(i01.actual_disc_terms_total_cost_amount),
  SUM(i01.actual_mos_total_cost_amount),
  SUM(i01.actual_net_sales_regular_units),
  SUM(i01.actual_net_sales_promo_units),
  SUM(i01.actual_net_sales_clearance_units),
  SUM(i01.actual_net_sales_total_units),
  SUM(i01.actual_receipts_regular_retail_amount),
  SUM(i01.actual_receipts_clearance_retail_amount),
  SUM(i01.actual_receipts_regular_cost_amount),
  SUM(i01.actual_receipts_clearance_cost_amount),
  SUM(i01.actual_receipts_regular_units),
  SUM(i01.actual_receipts_clearance_units),
  SUM(i01.actual_receipts_total_units),
  SUM(i01.actual_onorder_regular_retail_amount),
  SUM(i01.actual_onorder_clearance_retail_amount),
  SUM(i01.actual_onorder_total_retail_amount),
  SUM(i01.actual_onorder_regular_cost_amount),
  SUM(i01.actual_onorder_clearance_cost_amount),
  SUM(i01.actual_onorder_total_cost_amount),
  SUM(i01.actual_onorder_regular_units),
  SUM(i01.actual_onorder_clearance_units),
  SUM(i01.actual_onorder_total_units),
  SUM(i01.actual_inv_bop_regular_retail_amount),
  SUM(i01.actual_inv_bop_clearance_retail_amount),
  SUM(i01.actual_inv_bop_total_retail_amount),
  SUM(i01.actual_inv_bop_regular_cost_amount),
  SUM(i01.actual_inv_bop_clearance_cost_amount),
  SUM(i01.actual_inv_bop_total_cost_amount),
  SUM(i01.actual_inv_bop_regular_units),
  SUM(i01.actual_inv_bop_clearance_units),
  SUM(i01.actual_inv_bop_total_units),
  SUM(i01.actual_inv_eop_regular_retail_amount),
  SUM(i01.actual_inv_eop_clearance_retail_amount),
  SUM(i01.actual_inv_eop_total_retail_amount),
  SUM(i01.actual_inv_eop_regular_cost_amount),
  SUM(i01.actual_inv_eop_clearance_cost_amount),
  SUM(i01.actual_inv_eop_total_cost_amount),
  SUM(i01.actual_inv_eop_regular_units),
  SUM(i01.actual_inv_eop_clearance_units),
  SUM(i01.actual_inv_eop_total_units),
  SUM(i01.actual_transfer_in_total_retail_amount),
  SUM(i01.actual_transfer_in_total_cost_amount),
  SUM(i01.actual_transfer_in_total_units),
  SUM(i01.actual_transfer_out_total_retail_amount),
  SUM(i01.actual_transfer_out_total_cost_amount),
  SUM(i01.actual_transfer_out_total_units),
  SUM(i01.actual_transfer_in_racking_retail_amount),
  SUM(i01.actual_transfer_in_racking_cost_amount),
  SUM(i01.actual_transfer_in_racking_units),
  SUM(i01.actual_transfer_out_racking_retail_amount),
  SUM(i01.actual_transfer_out_racking_cost_amount),
  SUM(i01.actual_transfer_out_racking_units),
  SUM(i01.actual_rtv_total_cost_amount),
  SUM(i01.actual_rtv_total_units),
  SUM(i01.planned_net_sales_total_units),
  SUM(i01.planned_receipts_total_retail_amount),
  SUM(i01.planned_receipts_total_cost_amount),
  SUM(i01.planned_receipts_total_units),
  SUM(i01.planned_inv_total_retail_amount),
  SUM(i01.planned_inv_total_cost_amount),
  SUM(i01.planned_inv_total_units),
  SUM(i01.planned_inv_bop_total_units),
  SUM(i01.planned_inv_bop_total_cost_amount),
  SUM(i01.planned_rack_transfer_cost_amount),
  SUM(i01.planned_rack_transfer_units),
  SUM(i01.planned_rtv_total_cost_amount),
  SUM(i01.planned_rtv_total_units),
  current_date('PST8PDT'),
  CAST(FORMAT_TIMESTAMP('%F %H:%M:%E6S', CURRENT_DATETIME('PST8PDT')) AS DATETIME)
FROM
  `{{params.gcp_project_id}}`.{{params.dbenv}}_nap_stg.merch_ap_plan_actual_suppgrp_banner_wrk AS i01
GROUP BY
  1,
  2,
  3,
  4,
  5,
  6 ;