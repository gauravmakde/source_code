{
    "dag_id": "hr_organization_events_load",
    "dag_schedule": "45 21 * * *",
    "stages": [
        "hr_org_events"
    ],
    "hr_org_events": {
        "load_0_stg_tables": {
            "spark_engine": {
                "spark_run_mode": "low",
                "scripts": [
                    "hr_organization_load_stg.sql"
                ],
                "input_details": [
                    {
                        "conn_name": "__HR_ORGANIZATION_EVENTS_KAFKA__",
                        "sql_table_reference": "kafka_hr_org_input",
                        "data_source_name": "humanresources-organization-changed-avro"
                    }
                ],
                "output_details": [
                    {
                        "conn_name": "__TERADATA_NAP_HR_STG__",
                        "sql_table_reference": "td_org_ldg_table",
                        "data_source_name": "HR_WORKER_ORG_LDG"
                    }
                ]
            }
        },
        "load_1_dim_tables": {
            "teradata_engine": {
                "input_details": [
                    {
                        "conn_name": "__NEW_VAULT_TERADATA_NAP_HR_STG__",
                        "scripts": [
                            "hr_organization_load_dim.sql"
                        ]
                    }
                ]
            }
        }
    }
}