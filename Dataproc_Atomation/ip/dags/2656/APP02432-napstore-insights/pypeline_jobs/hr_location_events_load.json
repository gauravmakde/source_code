{
    "dag_id": "hr_location_events_load",
    "dag_schedule": "30 21 * * *",
    "stages": [
        "hr_loc_events"
    ],
    "hr_loc_events": {
        "load_0_stg_tables": {
            "spark_engine": {
                "spark_run_mode": "low",
                "scripts": [
                    "hr_location_load_stg.sql"
                ],
                "input_details": [
                    {
                        "conn_name": "__HR_LOCATION_EVENTS_KAFKA__",
                        "sql_table_reference": "kafka_hr_location_input",
                        "data_source_name": "humanresources-location-changed-avro"
                    }
                ],
                "output_details": [
                    {
                        "conn_name": "__TERADATA_NAP_HR_STG__",
                        "sql_table_reference": "td_location_ldg_table",
                        "data_source_name": "HR_WORKER_LOCATION_LDG"
                    }
                ]
            }
        },
        "load_1_dim_tables": {
            "teradata_engine": {
                "input_details": [
                    {
                        "conn_name": "__NEW_VAULT_TERADATA_NAP_HR_STG__",
                        "scripts": [
                            "hr_location_load_dim.sql"
                        ]
                    }
                ]
            }
        }
    }
}