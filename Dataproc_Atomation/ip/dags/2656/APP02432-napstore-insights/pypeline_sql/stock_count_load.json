{
  "dag_id": "stock_count_load_test",
  "dag_schedule": "0 9 * * *",
  "stages": [
    "stock_count"
  ],
  "stock_count": {
    "load_from_kafka_to_teradata_stg_table": {
      "spark_engine": {
        "spark_run_mode": "high",
        "scripts": [
          "stock_count_from_kafka_to_teradata_stg.sql"
        ],
        "input_details": [
          {
            "conn_name": "__STOCK_COUNT_KAFKA__",
            "sql_table_reference": "kafka_stock_count_input",
            "data_source_name": "stock-count-analytical-avro"
          }
        ],
        "output_details": [

          {
            "conn_name": "__TERADATA_NAP_STG__",
            "sql_table_reference": "stock_count_stg_table",
            "data_source_name": "STOCK_COUNT_STG"
          },
          {
            "conn_name": "__TERADATA_NAP_STG__",
            "sql_table_reference": "stock_count_criteria_stg_table",
            "data_source_name": "STOCK_COUNT_CRITERIA_STG"
          },
          {
            "conn_name": "__TERADATA_NAP_STG__",
            "sql_table_reference": "stock_count_submitted_details_stg_table",
            "data_source_name": "STOCK_COUNT_SUBMITTED_DETAILS_STG"
          },
          {
            "conn_name": "__TERADATA_NAP_STG__",
            "sql_table_reference": "stock_count_submitted_product_result_stg_table",
            "data_source_name": "STOCK_COUNT_SUBMITTED_PRODUCT_RESULT_STG"
          },
          {
            "conn_name": "__TERADATA_NAP_STG__",
            "sql_table_reference": "stock_count_submitted_product_result_counted_item_quantity_stg_table",
            "data_source_name": "STOCK_COUNT_SUBMITTED_PRODUCT_RESULT_COUNTED_ITEM_QUANTITY_STG"
          }
        ]
      }
    },
    "load_from_stg_to_fct_table": {
      "teradata_engine": {
        "input_details": [
          {
            "conn_name": "__TERADATA_NAP__",
            "scripts": [
              "stock_count_from_stg_to_fact.sql"
            ]
          }
        ]
      }
    }
  }
}
