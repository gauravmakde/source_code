{
    "dag_id": "fraud_decision_lifecycle_teradata",
    "dag_schedule": "0 */4 * * *",
    "stages": [
        "fraud_decision_lifecycle_kafka_to_teradata_stg_stage_0"
    ],
    "fraud_decision_lifecycle_kafka_to_teradata_stg_stage_0": {
        "kafka_to_teradata_stg_job": {
            "spark_engine": {
                "spark_run_mode": "medium",
                "scripts": [
                    "sparkSql/fraud_decision_lifecycle_kafka_to_teradata_stg.sql"
                ],
                "input_details": [
                    {
                        "conn_name": "__KAFKA_NAP_SOURCE_PAYMENTS__",
                        "sql_table_reference": "kafka_fraud_decision_lifecycle_analytical_avro",
                        "data_source_name": "customer-fraud-decision-lifecycle-analytical-avro"
                    }
                ],
                "output_details": [
                    {
                        "conn_name": "__PAYMENT_TERADATA_FRAUD_NAP_STG__",
                        "sql_table_reference": "fraud_decision_lifecycle_ldg",
                        "data_source_name": "FRAUD_DECISION_LIFECYCLE_LDG"
                    }
                ]
            }
        },
        "teradata_stg_to_teradata_fct_job": {
            "teradata_engine": {
                "input_details": [
                    {
                        "conn_name": "__PAYMENT_TERADATA_FRAUD_NAP_FCT__",
                        "scripts": [
                            "teradata/fraud_decision_lifecycle_teradata_stg_to_teradata_fct.sql"
                        ]
                    }
                ]
            }
        }
    }
}