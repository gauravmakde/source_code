{
    "dag_id": "payment_settlement_intent_teradata_v2",
    "dag_schedule": "0 */4 * * *",
    "stages": [
        "payment_settlement_intent_kafka_to_teradata_stg_stage_1",
        "payment_settlement_intent_hdr_td_stg_to_td_fct_stage_2",
        "payment_settlement_intent_tender_td_stg_to_td_fct_stage_3",
        "payment_settlement_intent_teradata_hdr_fct_update_payment_id_stage"
    ],
    "stage_dependencies": {
        "payment_settlement_intent_kafka_to_teradata_stg_stage_1": [
            "payment_settlement_intent_hdr_td_stg_to_td_fct_stage_2",
            "payment_settlement_intent_tender_td_stg_to_td_fct_stage_3"
        ],
        "payment_settlement_intent_hdr_td_stg_to_td_fct_stage_2": "payment_settlement_intent_teradata_hdr_fct_update_payment_id_stage",
        "payment_settlement_intent_tender_td_stg_to_td_fct_stage_3": "payment_settlement_intent_teradata_hdr_fct_update_payment_id_stage"
    },
    "payment_settlement_intent_kafka_to_teradata_stg_stage_1": {
        "settlement_intent_kafka_to_teradata_stg_job": {
            "spark_engine": {
                "spark_run_mode": "medium",
                "scripts": [
                    "sparkSql/payment_settlement_intent_v2_kafka_to_teradata_stg.sql"
                ],
                "input_details": [
                    {
                        "conn_name": "__KAFKA_NAP_SOURCE_PAYMENTS__",
                        "sql_table_reference": "kafka_payment_settlement_intent_analytical_avro",
                        "data_source_name": "customer-payment-settlement-intent-analytical-avro"
                    }
                ],
                "output_details": [
                    {
                        "conn_name": "__PAYMENT_TERADATA_NAP_STG__",
                        "sql_table_reference": "payment_settlement_intent_hdr_stg",
                        "data_source_name": "PAYMENT_SETTLEMENT_INTENT_HDR_V2_LDG"
                    },
                    {
                        "conn_name": "__PAYMENT_TERADATA_NAP_STG__",
                        "sql_table_reference": "payment_settlement_intent_stg",
                        "data_source_name": "PAYMENT_SETTLEMENT_INTENT_TENDER_V2_LDG"
                    }
                ]
            }
        }
    },
    "payment_settlement_intent_hdr_td_stg_to_td_fct_stage_2": {
        "payment_settlement_intent_hdr_td_stg_to_td_fct_job": {
            "teradata_engine": {
                "input_details": [
                    {
                        "conn_name": "__PAYMENT_TERADATA_NAP_FCT__",
                        "scripts": [
                            "teradata/payment_settlement_intent_hdr_stg_to_teradata_fct.sql"
                        ]
                    }
                ]
            }
        }
    },
    "payment_settlement_intent_tender_td_stg_to_td_fct_stage_3": {
        "payment_settlement_intent_tender_td_stg_to_td_fct_job": {
            "teradata_engine": {
                "input_details": [
                    {
                        "conn_name": "__PAYMENT_TERADATA_NAP_FCT__",
                        "scripts": [
                            "teradata/payment_settlement_intent_tender_stg_to_teradata_fct.sql"
                        ]
                    }
                ]
            }
        }
    },
    "payment_settlement_intent_teradata_hdr_fct_update_payment_id_stage": {
        "teradata_hdr_fct_update_job": {
            "teradata_engine": {
                "input_details": [
                    {
                        "conn_name": "__PAYMENT_TERADATA_NAP_FCT__",
                        "scripts": [
                            "teradata/payment_settlement_intent_teradata_hdr_fct_update_payment_id.sql"
                        ]
                    }
                ]
            }
        }
    }
}