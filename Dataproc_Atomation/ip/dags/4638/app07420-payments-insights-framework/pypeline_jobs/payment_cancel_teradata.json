{
  "dag_id": "payment_cancel_teradata",
  "dag_schedule": "0 2/4 * * *",
  "stages": [
    "payment_cancel_kafka_to_teradata_stg_stage_1",
    "payment_cancel_hdr_td_stg_to_td_fct_stage_2",
    "payment_cancel_dtl_td_stg_to_td_fct_stage_3",
    "payment_cancel_tender_td_stg_to_td_fct_stage_4"
  ],
  "stage_dependencies": {
    "payment_cancel_kafka_to_teradata_stg_stage_1": [
      "payment_cancel_hdr_td_stg_to_td_fct_stage_2",
      "payment_cancel_dtl_td_stg_to_td_fct_stage_3",
      "payment_cancel_tender_td_stg_to_td_fct_stage_4"
    ]
  },
  "payment_cancel_kafka_to_teradata_stg_stage_1": {
    "cancel_success_kafka_to_teradata_stg_job": {
      "spark_engine": {
        "spark_run_mode": "medium",
        "scripts": [
          "sparkSql/payment_cancel_success_kafka_to_teradata_stg.sql"
        ],
        "input_details": [
          {
            "conn_name": "KAFKA_NAP_SOURCE_PAYMENTS_CANCEL_SUCCESS",
            "sql_table_reference": "kafka_payment_cancel_success",
            "data_source_name": "order-events-avro"
          }
        ],
        "output_details": [
          {
            "conn_name": "__PAYMENT_TERADATA_NAP_STG__",
            "sql_table_reference": "payment_cancel_success_hdr_stg",
            "data_source_name": "PAYMENT_CANCEL_HDR_LDG"
          },
          {
            "conn_name": "__PAYMENT_TERADATA_NAP_STG__",
            "sql_table_reference": "payment_cancel_success_dtl_stg",
            "data_source_name": "PAYMENT_CANCEL_DTL_LDG"
          },
          {
            "conn_name": "__PAYMENT_TERADATA_NAP_STG__",
            "sql_table_reference": "payment_cancel_success_tender_stg",
            "data_source_name": "PAYMENT_CANCEL_TENDER_LDG"
          }
        ]
      }
    },
    "cancel_failed_kafka_to_teradata_stg_job": {
      "spark_engine": {
        "spark_run_mode": "medium",
        "scripts": [
          "sparkSql/payment_cancel_failed_kafka_to_teradata_stg.sql"
        ],
        "input_details": [
          {
            "conn_name": "KAFKA_NAP_SOURCE_PAYMENTS_CANCEL_FAILED",
            "sql_table_reference": "kafka_payment_cancel_failed",
            "data_source_name": "order-events-avro"
          }
        ],
        "output_details": [
          {
            "conn_name": "__PAYMENT_TERADATA_NAP_STG__",
            "sql_table_reference": "payment_cancel_failed_hdr_stg",
            "data_source_name": "PAYMENT_CANCEL_HDR_LDG"
          },
          {
            "conn_name": "__PAYMENT_TERADATA_NAP_STG__",
            "sql_table_reference": "payment_cancel_failed_dtl_stg",
            "data_source_name": "PAYMENT_CANCEL_DTL_LDG"
          },
          {
            "conn_name": "__PAYMENT_TERADATA_NAP_STG__",
            "sql_table_reference": "payment_cancel_failed_tender_stg",
            "data_source_name": "PAYMENT_CANCEL_TENDER_LDG"
          }
        ]
      }
    }
  },
  "payment_cancel_hdr_td_stg_to_td_fct_stage_2": {
    "payment_cancel_hdr_td_stg_to_td_fct_job": {
      "teradata_engine": {
        "input_details": [
          {
            "conn_name": "__PAYMENT_TERADATA_NAP_FCT__",
            "scripts": [
              "teradata/payment_cancel_hdr_stg_to_teradata_fct.sql"
            ]
          }
        ]
      }
    }
  },
  "payment_cancel_dtl_td_stg_to_td_fct_stage_3": {
    "payment_cancel_dtl_td_stg_to_td_fct_job": {
      "teradata_engine": {
        "input_details": [
          {
            "conn_name": "__PAYMENT_TERADATA_NAP_FCT__",
            "scripts": [
              "teradata/payment_cancel_dtl_stg_to_teradata_fct.sql"
            ]
          }
        ]
      }
    }
  },
  "payment_cancel_tender_td_stg_to_td_fct_stage_4": {
    "payment_cancel_tender_td_stg_to_td_fct_job": {
      "teradata_engine": {
        "input_details": [
          {
            "conn_name": "__PAYMENT_TERADATA_NAP_FCT__",
            "scripts": [
              "teradata/payment_cancel_tender_stg_to_teradata_fct.sql"
            ]
          }
        ]
      }
    }
  }
}