{
  "dag_id": "inventory_rfid_carton_scanned_load",
  "prod_email_on_failure":"TECH_NAP_SUPPLYCHAIN_OUTBOUND@nordstrom.com,nap-sco-high-pri@nordstrom.pagerduty.com",
  "nonprod_email_on_failure": "TECH_NAP_SUPPLYCHAIN_OUTBOUND@nordstrom.com",
  "dag_schedule": "0 21 * * *",
  "stages": [
    "stage_1_0"  ],
  "stage_1_0": {
    "job_1_td_batch_start": {
      "teradata_engine": {
        "input_details": [
          {
            "conn_name": "__TERADATA_NAP_FCT__",
            "scripts": [
              "rfid_carton_scanned/batch_start.sql"
            ]
          }
        ]
      }
    },
    "job_2_load_kafka_to_db_stg": {
      "spark_engine": {
        "spark_run_mode": "medium",
        "scripts": [
          "rfid_carton_scanned/carton_scanned_from_kafka_to_teradata_stg.sql"
        ],
        "input_details": [
          {
            "conn_name": "__RFID_CARTON_SCANNED_KAFKA__",
            "sql_table_reference": "kafka_carton_scanned_input",
            "data_source_name": "inventory-store-carton-rfid-scanned-avro"
          }
        ],
        "output_details": [

          {
            "conn_name": "__TERADATA_NAP_STG__",
            "sql_table_reference": "carton_scanned_stg_table",
            "data_source_name": "INVENTORY_STORE_CARTON_RFID_SCANNED_LDG"
          }
        ]
      }
    },
    "job_3_load_stg_to_fct_table": {
      "teradata_engine": {
        "input_details": [
          {
            "conn_name": "__TERADATA_NAP_FCT__",
            "scripts": [
              "rfid_carton_scanned/carton_scanned_from_stg_to_fact.sql"
            ]
          }
        ]
      }
    },
    "job_31_teradata_fact_dqc": {
      "teradata_engine": {
        "retries": 0,
        "input_details": [
          {
            "conn_name": "__TERADATA_NAP_FCT__",
            "scripts": [
              "rfid_carton_scanned/td_fact_dqc.sql"
            ]
          }
        ]
      }
    },
    "job_4_td_batch_end": {
      "teradata_engine": {
        "input_details": [
          {
            "conn_name": "__TERADATA_NAP_FCT__",
            "scripts": [
              "rfid_carton_scanned/batch_end.sql"
            ]
          }
        ]
      }
    }
  }
}
