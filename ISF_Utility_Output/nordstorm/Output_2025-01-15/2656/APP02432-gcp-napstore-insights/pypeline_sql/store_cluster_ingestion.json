{
  "dag_id": "store_cluster_xref_load",
  "dag_schedule": "0 9 * * 1-5",
  "prod_email_on_failure": "nap-customer-selling@nordstrom.pagerduty.com",
  "stages":[
    "load"
  ],
  "load":{
    "ldg_to_dim_0_start_batch": {
      "teradata_engine": {
        "input_details": [
          {
            "conn_name": "__TERADATA_NAP_STG__",
            "scripts": [
              "store_cluster_xref_elt_control_start_updt.sql"
            ]
          }
        ]
      }
    },
    "csv_to_ldg": {
      "tpt_engine": {
        "input_details": [
          {
            "conn_name": "__TERARATA_NAP_TPT__",
            "table_name": "STORE_CLUSTER_XREF_LDG",
            "load_type": "LOAD -z",
            "s3_file_path": "s3://{store_cluster_xref_bucket_name}/JWN_AssortmentClusters.csv"
          }
        ],
        "output_details": []
      }
    },
    "ldg_to_dim_0_audit_check": {
      "teradata_engine": {
        "input_details": [
          {
            "conn_name": "__TERADATA_NAP_STG__",
            "scripts": [
              "store_cluster_xref_audit_check.sql"
            ]
          }
        ]
      }
    },
    "ldg_to_dim_1_run_sql": {
      "teradata_engine": {
        "input_details": [
          {
            "conn_name": "__TERADATA_NAP_STG__",
            "scripts": [
              "store_cluster_xref_ldg_to_dim.sql"
            ]
          }
        ]
      }
    },
    "ldg_to_dim_2_end_batch": {
      "teradata_engine": {
        "input_details": [
          {
            "conn_name": "__TERADATA_NAP_STG__",
            "scripts": [
              "store_cluster_xref_elt_control_end_updt.sql"
            ]
          }
        ]
      }
    }
  }
}
