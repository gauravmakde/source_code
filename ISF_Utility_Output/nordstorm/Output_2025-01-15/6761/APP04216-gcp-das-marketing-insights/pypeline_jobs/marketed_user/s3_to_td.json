{
    "dag_id": "marketed_user",
    "dag_schedule": "00 22 * * *",
    "prod_email_on_failure": "nap-marketing@nordstrom.pagerduty.com",
    "nonprod_email_on_failure": "yu-lin.chou@nordstrom.com",
    "stages": [
        "read_s3_to_teradata"
    ],
    "read_s3_to_teradata": {
        "s3_to_stg": {
            "spark_engine": {
                "spark_run_mode": "low",
                "scripts": [
                    "s3_to_stg.sql"
                ],
                "input_details": [
                    {
                        "conn_name": "__S3_MARKETED_USER_DATA_CSV__",
                        "sql_table_reference": "s3_read_marketed_user_tbl"
                    }
                ],
                "output_details": [
                    {
                        "conn_name": "__Teradata_MARKETED_USER_Source__",
                        "sql_table_reference": "write_teradata_marketed_user_tbl",
                        "data_source_name": "MARKETED_USER_STG"
                    }
                ]
            }
        },
        "stg_to_fct": {
            "teradata_engine": {
                "input_details": [
                    {
                        "conn_name": "__Teradata_NAP_Source__",
                        "scripts": [
                            "stg_to_fct.sql"
                        ]
                    }
                ]
            }
        }
    }
}