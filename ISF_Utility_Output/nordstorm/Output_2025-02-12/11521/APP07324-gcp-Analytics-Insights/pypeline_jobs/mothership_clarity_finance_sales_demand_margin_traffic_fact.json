{
    "dag_id": "mothership_clarity_finance_sales_demand_margin_traffic_fact",
    "dag_schedule": "10 10 * * 0-5",
    "dag_sla_minutes": "140",
    "nonprod_email_on_failure": "matthew.bond@nordstrom.com",
    "prod_email_on_failure": "dsa-app08176-e2e-finance-t2dl-das-mothership@nordstrom.pagerduty.com, tech_ffp_analytics@nordstrom.com, fin_e2e_sales@nordstrom.com",
    "dependencies": {
        "upstream": {
            "dags": [
                {
                    "external_dag_id": "mothership_clarity_finance_sales_demand_fact_11521_ACE_ENG",
                    "retries": 3,
                    "poke_interval": 120,
                    "timeout": 3600
                }
            ]
        }
    },
    "stage_dependencies": {
        "run_clarity_finance_sales_demand_margin_traffic_fact": [
            "fsdf_dq_check",
            "placer_dq_check"
        ]
    },
    "stages": [
        "run_clarity_finance_sales_demand_margin_traffic_fact",
        "fsdf_dq_check",
        "placer_dq_check"
    ],
    "sql_env_vars": {
        "start_date": "current_date()-30",
        "end_date": "current_date()"
    },
    "fsdf_dq_check": {
        "check_clarity_demand_opgmv": {
            "branch_engine": {
                "python_code": "mothership_fsdf_downstream_check.py",
                "callable_function_name": "callable_func_name",
                "provide_context": "True",
                "callable_return_vars": {
                    "task1": "run_clarity_finance_sales_demand_margin_traffic_fact",
                    "task2": "run_clarity_finance_sales_demand_margin_traffic_fact"
                }
            }
        }
    },
    "placer_dq_check": {
        "check_placer_data": {
            "branch_engine": {
                "python_code": "placer_store_traffic_upstream_check.py",
                "callable_function_name": "callable_func_name",
                "provide_context": "True",
                "callable_return_vars": {
                    "task1": "run_clarity_finance_sales_demand_margin_traffic_fact",
                    "task2": "run_clarity_finance_sales_demand_margin_traffic_fact"
                }
            }
        }
    },
    "run_clarity_finance_sales_demand_margin_traffic_fact": {
        "job_0": {
            "teradata_engine": {
                "input_details": [
                    {
                        "conn_name": "TERADATA_SOURCE_CLARITY",
                        "scripts": [
                            "clarity/clarity_finance_sales_demand_margin_traffic_fact.sql"
                        ]
                    }
                ]
            }
        }
    }
}