CALL SYS_MGMT.DROP_IF_EXISTS_SP ('{environment_schema}', 'mfp_cost_plan_actual_banner_country_history{env_suffix}', OUT_RETURN_MSG);
CREATE MULTISET TABLE {environment_schema}.mfp_cost_plan_actual_banner_country_history{env_suffix} ,FALLBACK , 
	NO BEFORE JOURNAL,
	NO AFTER JOURNAL,
	CHECKSUM = DEFAULT,
	DEFAULT MERGEBLOCKRATIO,
	MAP = TD_MAP1
(
     snapshot_plan_month_idnt INTEGER 
    ,snapshot_start_day_date DATE
    ,dept_num INTEGER
    ,week_num INTEGER
    ,banner_country_num INTEGER
    ,fulfill_type_num INTEGER
    ,cp_beginning_of_period_active_cost_amt DECIMAL(32,4)
    ,cp_beginning_of_period_active_inventory_target_qty DECIMAL(16,4)
    ,cp_beginning_of_period_active_qty DECIMAL(16,4)
    ,cp_beginning_of_period_inactive_cost_amt DECIMAL(32,4)
    ,cp_beginning_of_period_inactive_qty DECIMAL(16,4)
    ,cp_ending_of_period_active_cost_amt DECIMAL(32,4)
    ,cp_ending_of_period_active_qty DECIMAL(16,4)
    ,cp_ending_of_period_inactive_cost_amt DECIMAL(32,4)
    ,cp_ending_of_period_inactive_qty DECIMAL(16,4)
    ,cp_transfer_in_active_cost_amt DECIMAL(32,4)
    ,cp_transfer_in_active_qty DECIMAL(16,4)
    ,cp_transfer_out_active_cost_amt DECIMAL(32,4)
    ,cp_transfer_out_active_qty DECIMAL(16,4)
    ,cp_transfer_in_inactive_cost_amt DECIMAL(32,4)
    ,cp_transfer_in_inactive_qty DECIMAL(16,4)
    ,cp_transfer_out_inactive_cost_amt DECIMAL(32,4)
    ,cp_transfer_out_inactive_qty DECIMAL(16,4)
    ,cp_transfer_in_other_cost_amt DECIMAL(32,4)
    ,cp_transfer_in_other_qty DECIMAL(16,4)
    ,cp_transfer_out_other_cost_amt DECIMAL(32,4)
    ,cp_transfer_out_other_qty DECIMAL(16,4)
    ,cp_transfer_in_racking_cost_amt DECIMAL(32,4)
    ,cp_transfer_in_racking_qty DECIMAL(16,4)
    ,cp_transfer_out_racking_cost_amt DECIMAL(32,4)
    ,cp_transfer_out_racking_qty DECIMAL(16,4)
    ,cp_mark_out_of_stock_active_cost_amt DECIMAL(32,4)
    ,cp_mark_out_of_stock_active_qty DECIMAL(16,4)
    ,cp_mark_out_of_stock_inactive_cost_amt DECIMAL(32,4)
    ,cp_mark_out_of_stock_inactive_qty DECIMAL(16,4)
    ,cp_receipts_active_cost_amt DECIMAL(32,4)
    ,cp_receipts_active_qty DECIMAL(16,4)
    ,cp_receipts_inactive_cost_amt DECIMAL(32,4)
    ,cp_receipts_inactive_qty DECIMAL(16,4)
    ,cp_receipts_reserve_cost_amt DECIMAL(32,4)
    ,cp_receipts_reserve_qty DECIMAL(16,4)
    ,cp_reclass_in_cost_amt DECIMAL(32,4)
    ,cp_reclass_in_qty DECIMAL(16,4)
    ,cp_reclass_out_cost_amt DECIMAL(32,4)
    ,cp_reclass_out_qty DECIMAL(16,4)
    ,cp_return_to_vendor_active_cost_amt DECIMAL(32,4)
    ,cp_return_to_vendor_active_qty DECIMAL(16,4)
    ,cp_return_to_vendor_inactive_cost_amt DECIMAL(32,4)
    ,cp_return_to_vendor_inactive_qty DECIMAL(16,4)
    ,cp_vendor_funds_cost_amt DECIMAL(32,4)
    ,cp_discount_terms_cost_amt DECIMAL(32,4)
    ,cp_merch_margin_retail_amt DECIMAL(32,4)
    ,cp_inventory_movement_in_dropship_cost_amt DECIMAL(32,4)
    ,cp_inventory_movement_in_dropship_qty DECIMAL(16,4)
    ,cp_inventory_movement_out_dropship_cost_amt DECIMAL(32,4)
    ,cp_inventory_movement_out_dropship_qty DECIMAL(16,4)
    ,cp_other_inventory_adjustment_cost_amt DECIMAL(32,4)
    ,cp_other_inventory_adjustment_qty DECIMAL(16,4)
    ,cp_open_to_buy_receipts_active_cost_amt DECIMAL(32,4)
    ,cp_open_to_buy_receipts_inactive_cost_amt DECIMAL(32,4)
    ,op_beginning_of_period_active_cost_amt DECIMAL(32,4)
    ,op_beginning_of_period_active_inventory_target_qty DECIMAL(16,4)
    ,op_beginning_of_period_active_qty DECIMAL(16,4)
    ,op_beginning_of_period_inactive_cost_amt DECIMAL(32,4)
    ,op_beginning_of_period_inactive_qty DECIMAL(16,4)
    ,op_ending_of_period_active_cost_amt DECIMAL(32,4)
    ,op_ending_of_period_active_qty DECIMAL(16,4)
    ,op_ending_of_period_inactive_cost_amt DECIMAL(32,4)
    ,op_ending_of_period_inactive_qty DECIMAL(16,4)
    ,op_transfer_in_active_cost_amt DECIMAL(32,4)
    ,op_transfer_in_active_qty DECIMAL(16,4)
    ,op_transfer_out_active_cost_amt DECIMAL(32,4)
    ,op_transfer_out_active_qty DECIMAL(16,4)
    ,op_transfer_in_inactive_cost_amt DECIMAL(32,4)
    ,op_transfer_in_inactive_qty DECIMAL(16,4)
    ,op_transfer_out_inactive_cost_amt DECIMAL(32,4)
    ,op_transfer_out_inactive_qty DECIMAL(16,4)
    ,op_transfer_in_other_cost_amt DECIMAL(32,4)
    ,op_transfer_in_other_qty DECIMAL(16,4)
    ,op_transfer_out_other_cost_amt DECIMAL(32,4)
    ,op_transfer_out_other_qty DECIMAL(16,4)
    ,op_transfer_in_racking_cost_amt DECIMAL(32,4)
    ,op_transfer_in_racking_qty DECIMAL(16,4)
    ,op_transfer_out_racking_cost_amt DECIMAL(32,4)
    ,op_transfer_out_racking_qty DECIMAL(16,4)
    ,op_mark_out_of_stock_active_cost_amt DECIMAL(32,4)
    ,op_mark_out_of_stock_active_qty DECIMAL(16,4)
    ,op_mark_out_of_stock_inactive_cost_amt DECIMAL(32,4)
    ,op_mark_out_of_stock_inactive_qty DECIMAL(16,4)
    ,op_receipts_active_cost_amt DECIMAL(32,4)
    ,op_receipts_active_qty DECIMAL(16,4)
    ,op_receipts_inactive_cost_amt DECIMAL(32,4)
    ,op_receipts_inactive_qty DECIMAL(16,4)
    ,op_receipts_reserve_cost_amt DECIMAL(32,4)
    ,op_receipts_reserve_qty DECIMAL(16,4)
    ,op_reclass_in_cost_amt DECIMAL(32,4)
    ,op_reclass_in_qty DECIMAL(16,4)
    ,op_reclass_out_cost_amt DECIMAL(32,4)
    ,op_reclass_out_qty DECIMAL(16,4)
    ,op_return_to_vendor_active_cost_amt DECIMAL(32,4)
    ,op_return_to_vendor_active_qty DECIMAL(16,4)
    ,op_return_to_vendor_inactive_cost_amt DECIMAL(32,4)
    ,op_return_to_vendor_inactive_qty DECIMAL(16,4)
    ,op_vendor_funds_cost_amt DECIMAL(32,4)
    ,op_discount_terms_cost_amt DECIMAL(32,4)
    ,op_merch_margin_retail_amt DECIMAL(32,4)
    ,op_inventory_movement_in_dropship_cost_amt DECIMAL(32,4)
    ,op_inventory_movement_in_dropship_qty DECIMAL(16,4)
    ,op_inventory_movement_out_dropship_cost_amt DECIMAL(32,4)
    ,op_inventory_movement_out_dropship_qty DECIMAL(16,4)
    ,op_other_inventory_adjustment_cost_amt DECIMAL(32,4)
    ,op_other_inventory_adjustment_qty DECIMAL(16,4)
    ,sp_beginning_of_period_active_cost_amt DECIMAL(32,4)
    ,sp_beginning_of_period_active_inventory_target_qty DECIMAL(16,4)
    ,sp_beginning_of_period_active_qty DECIMAL(16,4)
    ,sp_beginning_of_period_inactive_cost_amt DECIMAL(32,4)
    ,sp_beginning_of_period_inactive_qty DECIMAL(16,4)
    ,sp_ending_of_period_active_cost_amt DECIMAL(32,4)
    ,sp_ending_of_period_active_qty DECIMAL(16,4)
    ,sp_ending_of_period_inactive_cost_amt DECIMAL(32,4)
    ,sp_ending_of_period_inactive_qty DECIMAL(16,4)
    ,sp_transfer_in_active_cost_amt DECIMAL(32,4)
    ,sp_transfer_in_active_qty DECIMAL(16,4)
    ,sp_transfer_out_active_cost_amt DECIMAL(32,4)
    ,sp_transfer_out_active_qty DECIMAL(16,4)
    ,sp_transfer_in_inactive_cost_amt DECIMAL(32,4)
    ,sp_transfer_in_inactive_qty DECIMAL(16,4)
    ,sp_transfer_out_inactive_cost_amt DECIMAL(32,4)
    ,sp_transfer_out_inactive_qty DECIMAL(16,4)
    ,sp_transfer_in_other_cost_amt DECIMAL(32,4)
    ,sp_transfer_in_other_qty DECIMAL(16,4)
    ,sp_transfer_out_other_cost_amt DECIMAL(32,4)
    ,sp_transfer_out_other_qty DECIMAL(16,4)
    ,sp_transfer_in_racking_cost_amt DECIMAL(32,4)
    ,sp_transfer_in_racking_qty DECIMAL(16,4)
    ,sp_transfer_out_racking_cost_amt DECIMAL(32,4)
    ,sp_transfer_out_racking_qty DECIMAL(16,4)
    ,sp_mark_out_of_stock_active_cost_amt DECIMAL(32,4)
    ,sp_mark_out_of_stock_active_qty DECIMAL(16,4)
    ,sp_mark_out_of_stock_inactive_cost_amt DECIMAL(32,4)
    ,sp_mark_out_of_stock_inactive_qty DECIMAL(16,4)
    ,sp_receipts_active_cost_amt DECIMAL(32,4)
    ,sp_receipts_active_qty DECIMAL(16,4)
    ,sp_receipts_inactive_cost_amt DECIMAL(32,4)
    ,sp_receipts_inactive_qty DECIMAL(16,4)
    ,sp_receipts_reserve_cost_amt DECIMAL(32,4)
    ,sp_receipts_reserve_qty DECIMAL(16,4)
    ,sp_reclass_in_cost_amt DECIMAL(32,4)
    ,sp_reclass_in_qty DECIMAL(16,4)
    ,sp_reclass_out_cost_amt DECIMAL(32,4)
    ,sp_reclass_out_qty DECIMAL(16,4)
    ,sp_return_to_vendor_active_cost_amt DECIMAL(32,4)
    ,sp_return_to_vendor_active_qty DECIMAL(16,4)
    ,sp_return_to_vendor_inactive_cost_amt DECIMAL(32,4)
    ,sp_return_to_vendor_inactive_qty DECIMAL(16,4)
    ,sp_vendor_funds_cost_amt DECIMAL(32,4)
    ,sp_discount_terms_cost_amt DECIMAL(32,4)
    ,sp_merch_margin_retail_amt DECIMAL(32,4)
    ,sp_inventory_movement_in_dropship_cost_amt DECIMAL(32,4)
    ,sp_inventory_movement_in_dropship_qty DECIMAL(16,4)
    ,sp_inventory_movement_out_dropship_cost_amt DECIMAL(32,4)
    ,sp_inventory_movement_out_dropship_qty DECIMAL(16,4)
    ,sp_other_inventory_adjustment_cost_amt DECIMAL(32,4)
    ,sp_other_inventory_adjustment_qty DECIMAL(16,4)
    ,sp_open_to_buy_receipts_active_cost_amt DECIMAL(32,4)
    ,sp_open_to_buy_receipts_inactive_cost_amt DECIMAL(32,4)
    ,dw_batch_date DATE
    ,dw_sys_load_tmstp TIMESTAMP(6)
    ,rcd_update_timestamp TIMESTAMP(6) WITH TIME ZONE
)
PRIMARY INDEX(snapshot_plan_month_idnt, week_num, dept_num, banner_country_num)
PARTITION BY RANGE_N(snapshot_start_day_date BETWEEN DATE '2011-01-01' AND DATE '2031-12-31' EACH INTERVAL '1' DAY , NO RANGE)
;

CALL SYS_MGMT.DROP_IF_EXISTS_SP ('{environment_schema}', 'mfp_cost_plan_actual_channel_history{env_suffix}', OUT_RETURN_MSG);
CREATE MULTISET TABLE {environment_schema}.mfp_cost_plan_actual_channel_history{env_suffix} ,FALLBACK , 
	NO BEFORE JOURNAL,
	NO AFTER JOURNAL,
	CHECKSUM = DEFAULT,
	DEFAULT MERGEBLOCKRATIO,
	MAP = TD_MAP1
(
     snapshot_plan_month_idnt                INTEGER 
    ,snapshot_start_day_date                 DATE
	,dept_num                                INTEGER
	,week_num                                INTEGER
	,channel_num                             INTEGER
	,fulfill_type_num                        INTEGER
	,cp_demand_flash_retail_amt              DECIMAL(32,4)
	,cp_demand_persistent_retail_amt         DECIMAL(32,4)
	,cp_demand_total_qty                     DECIMAL(16,4)
	,cp_demand_total_retail_amt              DECIMAL(32,4)
	,cp_gross_margin_retail_amt              DECIMAL(32,4)
	,cp_gross_sales_retail_amt               DECIMAL(32,4)
	,cp_gross_sales_qty                      DECIMAL(16,4)
	,cp_net_sales_retail_amt                 DECIMAL(32,4)
	,cp_net_sales_qty                        DECIMAL(16,4)
	,cp_net_sales_cost_amt                   DECIMAL(32,4)
	,cp_net_sales_trunk_club_retail_amt      DECIMAL(32,4)
	,cp_net_sales_trunk_club_qty             DECIMAL(16,4)
	,cp_returns_retail_amt                   DECIMAL(32,4)
	,cp_returns_qty                          DECIMAL(16,4)
	,cp_shrink_cost_amt                      DECIMAL(32,4)
	,cp_shrink_qty                           DECIMAL(16,4)
	,op_demand_flash_retail_amt              DECIMAL(32,4)
	,op_demand_persistent_retail_amt         DECIMAL(32,4)
	,op_demand_total_qty                     DECIMAL(16,4)
	,op_demand_total_retail_amt              DECIMAL(32,4)
	,op_gross_margin_retail_amt              DECIMAL(32,4)
	,op_gross_sales_retail_amt               DECIMAL(32,4)
	,op_gross_sales_qty                      DECIMAL(16,4)
	,op_net_sales_retail_amt                 DECIMAL(32,4)
	,op_net_sales_qty                        DECIMAL(16,4)
	,op_net_sales_cost_amt                   DECIMAL(32,4)
	,op_net_sales_trunk_club_retail_amt      DECIMAL(32,4)
	,op_net_sales_trunk_club_qty             DECIMAL(16,4)
	,op_returns_retail_amt                   DECIMAL(32,4)
	,op_returns_qty                          DECIMAL(16,4)
	,op_shrink_cost_amt                      DECIMAL(32,4)
	,op_shrink_qty                           DECIMAL(16,4)
	,sp_demand_flash_retail_amt              DECIMAL(32,4)
	,sp_demand_persistent_retail_amt         DECIMAL(32,4)
	,sp_demand_total_qty                     DECIMAL(16,4)
	,sp_demand_total_retail_amt              DECIMAL(32,4)
	,sp_gross_margin_retail_amt              DECIMAL(32,4)
	,sp_gross_sales_retail_amt               DECIMAL(32,4)
	,sp_gross_sales_qty                      DECIMAL(16,4)
	,sp_net_sales_retail_amt                 DECIMAL(32,4)
	,sp_net_sales_qty                        DECIMAL(16,4)
	,sp_net_sales_cost_amt                   DECIMAL(32,4)
	,sp_net_sales_trunk_club_retail_amt      DECIMAL(32,4)
	,sp_net_sales_trunk_club_qty             DECIMAL(16,4)
	,sp_returns_retail_amt                   DECIMAL(32,4)
	,sp_returns_qty                          DECIMAL(16,4)
	,sp_shrink_cost_amt                      DECIMAL(32,4)
	,sp_shrink_qty                           DECIMAL(16,4)
	,ty_demand_flash_retail_amt              DECIMAL(32,4)
	,ty_demand_persistent_retail_amt         DECIMAL(32,4)
	,ty_demand_total_qty                     BIGINT 
	,ty_demand_total_retail_amt              DECIMAL(32,4)
	,ty_gross_margin_retail_amt              DECIMAL(32,4)
	,ty_gross_sales_retail_amt               DECIMAL(32,4)
	,ty_gross_sales_qty                      BIGINT 
	,ty_net_sales_retail_amt                 DECIMAL(32,4)
	,ty_net_sales_qty                        BIGINT 
	,ty_net_sales_cost_amt                   DECIMAL(32,4)
	,ty_net_sales_trunk_club_retail_amt      DECIMAL(32,4)
	,ty_net_sales_trunk_club_qty             BIGINT 
	,ty_returns_retail_amt                   DECIMAL(32,4)
	,ty_returns_qty                          BIGINT 
	,ty_shrink_cost_amt                      DECIMAL(32,4)
	,ty_shrink_qty                           BIGINT 
	,ly_demand_flash_retail_amt              DECIMAL(32,4)
	,ly_demand_persistent_retail_amt         DECIMAL(32,4)
	,ly_demand_total_qty                     BIGINT 
	,ly_demand_total_retail_amt              DECIMAL(32,4)
	,ly_gross_margin_retail_amt              DECIMAL(32,4)
	,ly_gross_sales_retail_amt               DECIMAL(32,4)
	,ly_gross_sales_qty                      BIGINT 
	,ly_net_sales_retail_amt                 DECIMAL(32,4)
	,ly_net_sales_qty                        BIGINT 
	,ly_net_sales_cost_amt                   DECIMAL(32,4)
	,ly_net_sales_trunk_club_retail_amt      DECIMAL(32,4)
	,ly_net_sales_trunk_club_qty             BIGINT 
	,ly_returns_retail_amt                   DECIMAL(32,4)
	,ly_returns_qty                          BIGINT 
	,ly_shrink_cost_amt                      DECIMAL(32,4)
	,ly_shrink_qty                           BIGINT 
	,lly_demand_flash_retail_amt             DECIMAL(32,4)
	,lly_demand_persistent_retail_amt        DECIMAL(32,4)
	,lly_demand_total_qty                    BIGINT 
	,lly_demand_total_retail_amt             DECIMAL(32,4)
	,lly_gross_margin_retail_amt             DECIMAL(32,4)
	,lly_gross_sales_retail_amt              DECIMAL(32,4)
	,lly_gross_sales_qty                     BIGINT 
	,lly_net_sales_retail_amt                DECIMAL(32,4)
	,lly_net_sales_qty                       BIGINT 
	,lly_net_sales_cost_amt                  DECIMAL(32,4)
	,lly_net_sales_trunk_club_retail_amt     DECIMAL(32,4)
	,lly_net_sales_trunk_club_qty            BIGINT 
	,lly_returns_retail_amt                  DECIMAL(32,4)
	,lly_returns_qty                         BIGINT 
	,lly_shrink_cost_amt                     DECIMAL(32,4)
	,lly_shrink_qty                          BIGINT 
	,dw_batch_date                           DATE   
	,dw_sys_load_tmstp                       TIMESTAMP
    ,rcd_update_timestamp                    TIMESTAMP(6) WITH TIME ZONE
)
PRIMARY INDEX(snapshot_plan_month_idnt, week_num, dept_num, channel_num)
PARTITION BY RANGE_N(snapshot_start_day_date BETWEEN DATE '2011-01-01' AND DATE '2031-12-31' EACH INTERVAL '1' DAY , NO RANGE)
;