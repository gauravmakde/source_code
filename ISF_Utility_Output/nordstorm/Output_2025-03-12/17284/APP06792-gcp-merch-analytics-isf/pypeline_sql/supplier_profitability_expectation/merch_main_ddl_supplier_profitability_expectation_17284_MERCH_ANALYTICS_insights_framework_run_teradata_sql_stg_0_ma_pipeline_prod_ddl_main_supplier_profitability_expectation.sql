/*
Purpose:          Creates empty tables in {environment_schema} for Supplier Profitability
                            SUPPLIER_PROFITABILITY_EXPECTATION_CHANNEL_WEEK_DEPT
Variable(s):     {environment_schema} T2DL_DAS_STRATEGIC_BRAND_MANAGEMENT_REPORTING
Author:          Manuela Hurtado Gonzalez
*/



CALL SYS_MGMT.DROP_IF_EXISTS_SP ('T2DL_DAS_STRATEGIC_BRAND_MANAGEMENT_REPORTING', 'SUPPLIER_PROFITABILITY_EXPECTATION_CHANNEL_WEEK_DEPT', OUT_RETURN_MSG);
CREATE MULTISET TABLE T2DL_DAS_STRATEGIC_BRAND_MANAGEMENT_REPORTING.SUPPLIER_PROFITABILITY_EXPECTATION_CHANNEL_WEEK_DEPT
  ,FALLBACK ,
	NO BEFORE JOURNAL,
	NO AFTER JOURNAL,
	CHECKSUM = DEFAULT,
	DEFAULT MERGEBLOCKRATIO,
	MAP = TD_MAP1
	(
    ty_ly_ind VARCHAR(3) CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL COMPRESS ('TY', 'LY', 'LLY'),
    week_idnt INTEGER,
		fiscal_year_num INTEGER,
		fiscal_halfyear_num INTEGER,
		quarter_abrv VARCHAR(2)CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL,
		quarter_label VARCHAR(20)CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL,
		month_abrv VARCHAR(3)CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL,
		month_idnt INTEGER,
		month_label VARCHAR(20)CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL,
		week_label VARCHAR(20)CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL,
		week_desc VARCHAR(10)CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL,
		fiscal_week_num INTEGER,
		week_start_day_date DATE FORMAT 'YYYY/MM/DD' NOT NULL,
		week_end_day_date DATE FORMAT 'YYYY/MM/DD' NOT NULL,
		business_unit_desc VARCHAR(20)CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL,
		channel_num INTEGER,
		channel_desc VARCHAR(20)CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL,
		country_code VARCHAR(2) CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL COMPRESS ('US', 'CA'),
		banner VARCHAR(2) CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL COMPRESS ('FP', 'OP'),
		div_label VARCHAR(36) CHARACTER SET UNICODE NOT CASESPECIFIC,
	  sdiv_label VARCHAR(36) CHARACTER SET UNICODE NOT CASESPECIFIC,
	  dept_label VARCHAR(36) CHARACTER SET UNICODE NOT CASESPECIFIC,
	  dept_idnt INTEGER,
    supplier_number INTEGER,
    brand_name VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC,
    brand_label VARCHAR(50) CHARACTER SET UNICODE NOT CASESPECIFIC,
    brand_label_num INTEGER,
    npg_ind VARCHAR(1) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ('Y', 'N'),
    sb_ind VARCHAR(1) CHARACTER SET UNICODE NOT CASESPECIFIC COMPRESS ('Y', 'N'),
    supplier VARCHAR(40) CHARACTER SET UNICODE NOT CASESPECIFIC,
		supplier_group VARCHAR(20)CHARACTER SET UNICODE NOT CASESPECIFIC NOT NULL,
		NET_SALES_TOT_RETL DECIMAL(12,2) ,
		NET_SALES_TOT_REGULAR_RETL DECIMAL(12,2) ,
		NET_SALES_TOT_PROMO_RETL DECIMAL(12,2) ,
		NET_SALES_TOT_CLEARANCE_RETL DECIMAL(12,2) ,
		NET_SALES_TOT_COST DECIMAL(12,2) ,
		NET_SALES_TOT_REGULAR_COST DECIMAL(12,2) ,
		NET_SALES_TOT_PROMO_COST DECIMAL(12,2) ,
		NET_SALES_TOT_CLEARANCE_COST DECIMAL(12,2) ,
		NET_SALES_TOT_UNITS INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		NET_SALES_TOT_REGULAR_UNITS INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		NET_SALES_TOT_PROMO_UNITS INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		NET_SALES_TOT_CLEARANCE_UNITS INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		RETURNS_TOT_RETL DECIMAL(12,2) ,
		RETURNS_TOT_REGULAR_RETL DECIMAL(12,2) ,
		RETURNS_TOT_PROMO_RETL DECIMAL(12,2) ,
		RETURNS_TOT_CLEARANCE_RETL DECIMAL(12,2) ,
		RETURNS_TOT_COST DECIMAL(12,2) ,
		RETURNS_TOT_REGULAR_COST DECIMAL(12,2) ,
		RETURNS_TOT_PROMO_COST DECIMAL(12,2) ,
		RETURNS_TOT_CLEARANCE_COST DECIMAL(12,2) ,
		RETURNS_TOT_UNITS INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		RETURNS_TOT_REGULAR_UNITS INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		RETURNS_TOT_PROMO_UNITS INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		RETURNS_TOT_CLEARANCE_UNITS INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
    DROPSHIP_NET_SALES_TOT_RETL DECIMAL(12,2) ,
    DROPSHIP_NET_SALES_TOT_COST DECIMAL(12,2) ,
    DROPSHIP_NET_SALES_TOT_UNITS INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		DEMAND_TOT_AMT DECIMAL(12,2) ,
		DEMAND_REGULAR_AMT DECIMAL(12,2) ,
		DEMAND_PROMO_AMT DECIMAL(12,2) ,
		DEMAND_CLEARENCE_AMT DECIMAL(12,2) ,
		DEMAND_UNKNOWN_AMT DECIMAL(12,2) ,
		DEMAND_TOT_QTY INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		DEMAND_REGULAR_QTY INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		DEMAND_PROMO_QTY INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		DEMAND_CLEARENCE_QTY INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		DEMAND_UNKNOWN_QTY INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		TOTAL_RECEIPTS_units INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		TOTAL_RECEIPTS_cost DECIMAL(12,2) ,
		TOTAL_RECEIPTS_retail DECIMAL(12,2) ,
    DROPSHIP_RECEIPTS_units INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
    DROPSHIP_RECEIPTS_cost DECIMAL(12,2) ,
    DROPSHIP_RECEIPTS_retail DECIMAL(12,2) ,
		PACKANDHOLD_TRANSFER_IN_units INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		PACKANDHOLD_TRANSFER_OUT_units INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		RESERVESTOCK_TRANSFER_IN_units INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		RESERVESTOCK_TRANSFER_OUT_units INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		PACKANDHOLD_TRANSFER_IN_retail DECIMAL(12,2) ,
		PACKANDHOLD_TRANSFER_OUT_retail DECIMAL(12,2) ,
		PACKANDHOLD_TRANSFER_IN_cost DECIMAL(12,2) ,
		PACKANDHOLD_TRANSFER_OUT_cost DECIMAL(12,2) ,
		RESERVESTOCK_TRANSFER_IN_cost DECIMAL(12,2) ,
		RESERVESTOCK_TRANSFER_OUT_cost DECIMAL(12,2) ,
		RESERVESTOCK_TRANSFER_IN_retail DECIMAL(12,2) ,
		RESERVESTOCK_TRANSFER_OUT_retail DECIMAL(12,2) ,
		DISC_TERMS_cost DECIMAL(12,2) ,
	  VENDOR_FUNDS_RETAIL DECIMAL(12,2) ,
	 	VENDOR_FUNDS_COST DECIMAL(12,2) ,
		boh_total_cost DECIMAL(12,2) ,
		boh_total_units INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		boh_total_retail DECIMAL(12,2) ,
		boh_clearance_cost DECIMAL(12,2) ,
		boh_clearance_units INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		boh_clearance_retail DECIMAL(12,2) ,
		boh_regular_cost DECIMAL(12,2) ,
		boh_regular_units INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		boh_regular_retail DECIMAL(12,2) ,
		eoh_total_cost DECIMAL(12,2) ,
		eoh_total_units INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		eoh_total_retail DECIMAL(12,2) ,
		eoh_clearance_cost DECIMAL(12,2) ,
		eoh_clearance_units INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		eoh_clearance_retail DECIMAL(12,2) ,
		eoh_regular_cost DECIMAL(12,2) ,
		eoh_regular_units INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
		eoh_regular_retail DECIMAL(12,2) ,
		mos_total_cost_amt DECIMAL(12,2),
		mos_total_units DECIMAL(12,2),
		mos_total_retail_amt DECIMAL(12,2),
		RTV_TOTAL_COST DECIMAL(12,2),
		RTV_TOTAL_RETAIL DECIMAL(12,2),
		RTV_TOTAL_UNITS INTEGER COMPRESS (0 ,1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 ,9 ,10 ,11 ,12 ,13 ,14 ,15 ,16 ,17 ,18 ,19 ,20 ,21 ,22 ,24 ,25 ) ,
    PROFITABILITY_EXPECTATION DECIMAL(12,2),
    REG_SALES_EXPECTATION DECIMAL(12,2),
    INITIAL_MARKUP_EXPECTATION DECIMAL(12,2),
		process_tmstp TIMESTAMP(6) WITH TIME ZONE
	)

PRIMARY INDEX (
		week_idnt,
		channel_num,
		supplier_number,
		dept_idnt)

PARTITION BY RANGE_N(week_idnt BETWEEN 202101 AND 202453 EACH 1);


GRANT SELECT ON T2DL_DAS_STRATEGIC_BRAND_MANAGEMENT_REPORTING.SUPPLIER_PROFITABILITY_EXPECTATION_CHANNEL_WEEK_DEPT TO PUBLIC;
